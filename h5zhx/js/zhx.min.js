!function(i){Array.prototype.p=Array.prototype.push,Date.prototype.format=function(i){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in e)new RegExp("("+t+")").test(i)&&(i=i.replace(RegExp.$1,1==RegExp.$1.length?e[t]:("00"+e[t]).substr((""+e[t]).length)));return i};var e={jsonp:function(i,e,t,a,l){zhx.data.jsonp(i,e).success(function(i){t&&t(i)}).error(function(i){a&&a(i)}).complete(function(i){l&&l(i)})},getPageNumber:function(i,e,t,a){var l=[],n=t||5,s=1,o=1,d=Math.floor(n/2);i-d<=1+a?(s=1,o=n>e?e:n+a):(s=i-d,i+d+a>=e?(s=e-a-n+1,o=e):o=i+d),s<=0&&(s=1),o>e&&(o=e);for(var c=s;c<=o;c++)l.push(c);return l},bindPageNubmer:function(i,e,t,a){var l=[],n=e.num,s=n.length;if(t&&n[0]-t>=0){for(var o=1;o<=t;o++)o<n[0]&&l.push('<a  href = "javascript:void(0)">'+o+"</a>");n[0]-t>1&&l.push("<label>......</label>")}for(var d=0;d<s;d++)n[d]==e.select?l.push('<a class="active">'+n[d]+"</a>"):l.push("<a>"+n[d]+"</a>");if(t&&n[s-1]<=a-t){n[s-1]<a-t&&l.push("<label>......</label>");for(var c=t;c>0;c--)a-c+1>n[s-1]&&l.push('<a  href = "javascript:void(0)">'+(a-c+1)+"</a>")}i.html(l.join(" "))},format:function(i,e){var t=i;for(var a in e)if(e.hasOwnProperty(a)){var l=e[a];void 0!=l&&(t=t.replace(new RegExp("\\{"+a+"\\}","gm"),l))}return t}};i.extend(i.fn,{tree:function(e){function t(i,e,t,a){var l=[];return e[o]&&e[o].length?(l.push("folder"),a&&1==i.length?l.push("one-folder"):(t||l.push("first-folder"),t==i.length-1&&l.push("last-folder"))):(l.push("file"),a&&1==i.length?l.push("one-file"):(t||l.push("first-file"),t==i.length-1&&l.push("last-file"))),l.join(" ")}function a(e,l,n){return e&&i.each(e,function(i){l.push('<li class="'+t(e,this,i,n)+'">'),l.push('<a><i class="i-icon"></i><i class="i-type"></i><label data-val="'+this[s.idStr]+'">'+this[s.nameStr]+"</label></a>"),this[o]&&this[o].length&&(l.push("<ul>"),a(this[o],l,!1),l.push("</ul>")),l.push("</li>")}),l}var l=i(this),n={},s=i.extend({},n,e),o=s.nextStr,d=a(s.list,[],!0);l.find(".tree-main").html(d.join(" ")),l.find(".tree-main").bind("click",function(e){var t,a=i(e.target);if("UL"!=e.target.nodeName)return t="A"==e.target.nodeName?a.parent("li"):"I"==e.target.nodeName||"LABEL"==e.target.nodeName?a.parent("a").parent("li"):a,t.hasClass("folder")?(t.toggleClass("folder-open"),t.hasClass("first-folder")&&t.toggleClass("first-folder-open"),t.hasClass("last-folder")&&t.toggleClass("last-folder-open"),t.hasClass("one-folder")&&t.toggleClass("one-folder-open")):(l.find("input").val(t.find("label").text()),l.attr("data-val",t.find("label").attr("data-val")),l.find(".i-close").show(),l.find(".tree-main").hide()),!1}),l.find(".i-close").bind("click",function(){return l.attr("data-val",""),l.find("input").val(""),l.find(".i-close").hide(),!1}),l.find("input").bind("click",function(){return l.find(".tree-main").show(),i(window).bind("click.tree",function(){console.log("click.tree"),l.find(".tree-main").hide(),i(window).unbind("click.tree")}),!1})},flowerPage:function(t){function a(){var e=d.listCount;c.pageShow=!0,c.count=Math.ceil(e/d.pageSize),c.count<=1?o.find(".page-left").hide():o.find(".page-left").show();var t=function(){var i=s.getPageNumber(d.pageIndex,c.count,d.numCount,d.prefixCount);return{num:i,select:c.index}};c.list=t();var a=o.find(".page-nubmer");a.find("a").unbind("click.page"),s.bindPageNubmer(a,c.list,d.prefixCount,c.count),a.find("a").bind("click.page",function(){d.pageIndex=Number(i(this).text())||1,l()}),o.find(".go-page").val(c.index),o.find(".page-size").text(c.size),o.find(".sun-page").text(c.count),o.find(".sun-counts").text(e)}function l(i){c.count>0&&d.pageIndex>c.count&&(d.pageIndex=c.count),c.index=d.pageIndex,c.size=d.pageSize;var t=s.format(d.url,{pageIndex:d.pageIndex,pageSize:d.pageSize}),l=0;d.loading&&(l=setTimeout(function(){d.loading()},d.loadTime)),d.before&&d.before(),e[d.method](t,d.data,function(e){"function"==typeof d.success&&(d.success(e,d),a(i))},function(){"function"==typeof d.error&&(d.error(),a(i))},function(){l&&(clearTimeout(l),d.closeLoading&&d.closeLoading())})}var n={url:"",numCount:5,prefixCount:0,pageIndex:1,pageSize:10,params:null,data:null,list:[],listCount:0,loading:null,loadTime:300,closeLoading:null,before:null,success:null,method:"jsonp",error:null},s=e,o=i(this),d=i.extend({},n,t),c={pageShow:!1,size:10,index:1,count:0};return o.find(".first").bind("click",function(){d.pageIndex=1,l()}),o.find(".prev").bind("click",function(){d.pageIndex<=1||(d.pageIndex--,l())}),o.find(".next").bind("click",function(){d.pageIndex>=c.count||(d.pageIndex++,l())}),o.find(".last").bind("click",function(){d.pageIndex=c.count,l()}),o.find(".go-page").bind("focus",function(e){i(this).unbind("keydown").bind("keydown",function(e){if(13==e.which){var t=i(this),a=t.val();if(isNaN(a))return void t.focus();a=Number(a),a<=0&&(a=1),a>c.count&&(a=c.count),d.pageIndex=a,t.val(a),l()}})}),o.find(".btn-page-refresh").bind("click",function(){var i=o.find(".page-index"),e=o.find(".page-size"),t=i.val(),a=e.val();return isNaN(t)?void i.focus():isNaN(a)?void e.focus():(t=Number(t),t<=0&&(t=1),t>c.count&&(t=c.count),d.pageIndex=t,d.pageSize=Number(a),i.val(t),void l())}),o.find(".btn-page-all").bind("click",function(){var i=d.pageSize;d.pageIndex=1,d.pageSize=d.listCount,l(1),d.pageSize=i}),{info:d,config:function(e){return i.extend(d,e),c},jsonp:function(e,t,a,n){return d.method="jsonp",d.pageIndex=1,i.extend(d,{url:e,success:a,data:t},n),l(),c},reset:function(){d.pageIndex=1,l()},update:l}}})}(jQuery),function(i){function e(i){var e=[];return e.push('<div class = "active-bor">'),e.push("</div>"),e.push('<div class = "op-box">'),i.isDelete&&(e.push('<a class="op-del" >删除</a>'),e.push('<div class="del-tip-box"><span>确定删除吗？</span><a class="tip-cel">取消</a><a class="tip-ok">确定</a><i class="i-1"></i><i class="i-2"></i></div>')),e.push("</div>"),e.join(" ")}var t={ac:"active",plugins:{},pluginList:[],holdPluginList:[],removePluginItem:function(i){var e=this.getPluginItemIndex(i);~e&&(this.pluginList[e].destroy&&this.pluginList[e].destroy(),this.pluginList.splice(e,1))},getPluginItemIndex:function(e){var t=-1;return i.each(this.pluginList,function(i){this.id==e&&(t=i)}),t},opList:[],dataList:[],showEdit:function(i,e){t.getEditBox.css("marginTop",e),t.showSetting("set_"+i)},addPlugin:function(a,l){function n(a){this.create=function(l,n){var s=i.extend(!0,{key:a},this.data,n),o=i(this.viewTemplate(s)),d=i(this.settingTemplate(s));d.hide();var c={id:[a,"_"+(new Date).getTime()].join(""),"data-type":a};o.attr(c),this.isShowOp&&o.append(e(this)),d.attr("id","set_"+c.id),this.noView||t.addView(o,l),t.addEditView(d);var r=function(){this.id=c.id,this.view=o,this.editView=d,this.data=s};r.prototype=this;var p=new r;return p.viewElem=o,p.settingElem=d,this.init.call(p,o,d),this.noView?(t.bindEditEvent(o),t.holdPluginList.push(p)):(t.pluginList.push(p),t.bindMousedownEvent(o),t.bindInitEvent(o)),t.resetPrivewList(),p}}n.prototype=l();var s=new n(a);this.plugins[a]=s},tabChangeClass:function(e,a,l){i.each(e,function(){i(this).removeClass(l||t.ac)}),a.addClass(l||t.ac)},changeClass:function(e,t,a){i.each(t,function(i,t){e.removeClass(t)}),e.addClass(t[a])},getSearchName:function(e){var t=location.search.replace(/\?/,""),a=t.split("&"),l={};return i.each(a,function(){var i=this.split("=");l[i[0]]=decodeURIComponent(i[1])}),l[e]||""},int:function(i){return i&&!isNaN(i)?- -i:0},other:{radio:function(e,t){var a={};e.each(function(){var e=i(this),l=e.find("input").attr("name");a[l]||(a[l]=[]),a[l].push(e),e.unbind("click.label").bind("click.label",function(n){var s=i(this).find("input"),o=a[l];return i.each(o,function(){this.removeClass("label-radio-active"),this.find("input").prop("checked","")}),e.addClass("label-radio-active"),s.prop("checked","checked"),t&&t.call(s,l,s.val(),n),!1})})},checkbox:function(e,t){e.unbind("click.label").bind("click.label",function(e){var a=i(this),l=a.find("input"),n=!!l.prop("checked");a.toggleClass("label-checkbox-active",!n);var s=l.attr("name");return l.prop("checked",!n),t&&t.call(l,s,!n,e),!1})},activeCheck:function(e,t,a){i.each(e,function(){var e=i(this),l=e.find("input");e.toggleClass("label-checkbox-active",t),l.prop("checked",t),a&&a.call(l,t)})},select:function(e,t){i.each(e,function(){var e=i(this);e.hover(function(){e.addClass("label-active")},function(){e.removeClass("label-active")}),e.find("label").not(".dis-label").unbind("click.label").bind("click.label",function(a){var l=i(this),n=l.attr("data-val"),s=l.text();return e.find("label").removeClass("select"),l.addClass("select"),e.removeClass("label-active"),t&&t.call(e,{value:n,text:s},a),!1})})}}};i.zhx=t,window.zhx=t}(jQuery),function(i){zhx.config={root:i(".preview"),editRoot:i(".setContent"),editClassName:"active",imgroot:"//i2.beta.ulecdn.com/mobile/decorate/161226/images/",store:null,plugin:["editor","goods","goodsList","textTitle","textNav","hr","imgAd","imgNav","goodsSearch","notice","blank","enterStore"]},location.host.indexOf("localhost")>=0&&zhx.config.plugin.push("goodsGroup")}(jQuery),function(i){function e(){o=!1;try{i(document).unbind("mousemove").unbind("mouseup"),n.hide(),s.removeAttr("style"),zhx.resizeEditView(s)}catch(i){}}function t(i){var e;o&&(e=a+i.clientY-l,n.css({top:e+"px"}),zhx.moveElem(s,e))}var a,l,n,s,o=!1;i.fn.extend({dragStar:function(d,c){n=d,s=i(this);var r=c||event;o=!0,i(document).bind("mousemove",function(i){t(i||event)}).bind("mouseup",e),l=r.clientY,a=s[0].offsetTop,n.html(s[0].outerHTML),s.css("visibility","hidden"),n.css({top:a}),n.show(),n.find(">div").addClass(zhx.config.editClassName)},shareDrag:function(e,t,a,l){zhx._shareList=t,t.each(function(){i(this).removeAttr("style")}),s=i(this),n=e;var o=l||event,d=o.clientY,c=s[0].offsetTop,r=!0;n.html(s.children().clone()),s.css("visibility","hidden"),n.css({top:c}),n.show(),i(document).bind("mousemove",function(i){var e,t=i||event;r&&(e=c+t.clientY-d,n.css({top:e+"px"}),zhx.shareMoveElem(s,e,a))}).bind("mouseup",function(){r=!1;try{i(document).unbind("mousemove").unbind("mouseup"),n.hide(),s.removeAttr("style")}catch(i){}})}})}(jQuery),function(){zhx.data={};var i="beta.ule.com",e=location.host;e.indexOf("ule.com")>=0&&e.indexOf("beta.ule.com")<0&&(i="ule.com"),$.extend(zhx.data,{urlSrc:i,host:"//m."+i+"/microshop",jsonp:function(i,e,t){return $.ajax({url:i,dataType:"jsonp",data:e,jsonp:t||"callback"})},post:function(i,e){return $.ajax({url:i,type:"post",dataType:"json",data:e})},upload:function(i,e){return $.ajax({url:i,type:"post",dataType:"json",data:e,processData:!1,contentType:!1})},put:function(i,e){return $.ajax({url:i,type:"put",contentType:"application/json; charset=utf-8",dataType:"json",data:e})},_goods:{brandList:[],categroyList:[],storeCategoryList:[],listingList:[]},getBaseInfo:function(i){var e={microshoppId:zhx.config.store.id,searchFlag:"1,2,3"};return $.extend(e,i),this.jsonp(this.host+"/api/finding/v1/groupListing",e).then(function(i){return zhx.data._goods.brandList=i.map.brandList,zhx.data._goods.categroyList=i.map.categroyList,zhx.data._goods.storeCategoryList=i.map.storeCategoryList,i.map})},getGoods:function(i){var e={microshoppId:zhx.config.store.id};return $.extend(e,i),this.jsonp(this.host+"/api/finding/v1/listings",e).then(function(i){return i.result})},getBrandList:function(i){return this._goods.brandList.length?$.when(this._goods.brandList):this.getBaseInfo(i).then(function(i){return i.brandList})},getStoreList:function(i){return this._goods.storeCategoryList.length?$.when(this._goods.storeCategoryList):this.getBaseInfo(i).then(function(i){return i.storeCategoryList})},getCategroyList:function(i){return this._goods.categroyList.length?$.when(this._goods.categroyList):this.getBaseInfo(i).then(function(i){return i.categroyList})},uploadImg:function(i){var e=new FormData;return e.append("uploadFlag ","1"),e.append("storeId  ",zhx.config.store.id),e.append("myfile ",i),this.upload(zhx.config.store.basePath+"/api/v1/resource/save",e)}})}(),function(i){i.extend(zhx,{bindEditEvent:function(i){var e=i||this.previewList;return e.bind("click",function(){zhx.activeView(i)}),this},bindMousedownEvent:function(e){var t=e||this.previewList;return t.find(".active-bor").bind("mousedown",function(e){var t=i(this).parent();zhx.activeView(t),t.dragStar(zhx.moveBox,e)}),this},bindOpEvent:function(){return this.config.root.find(".op-list").bind("click",function(e){if("A"==e.target.nodeName){var t=i(e.target),a=t.attr("data-type"),l=zhx.plugins[a].create();zhx.activeView(l.viewElem)}}),this},bindInitEvent:function(e){var t=e.find(".op-box");t.find(".op-del").bind("click",function(){e.find(".del-tip-box").show(),e.bind("mouseleave",function(){e.find(".del-tip-box").hide(),e.unbind("mouseleave")})}),e.find(".tip-ok").bind("click",function(){e.find(".tip-ok").unbind("click");var t=e.attr("id"),a=e.prev();a.hasClass("move-box")?zhx.getEditBox.hide():zhx.activeView(a),e.remove(),i("#set_"+t).remove(),zhx.removePluginItem(t),zhx.resetPrivewList()}),e.find(".tip-cel").bind("click",function(){e.find(".del-tip-box").hide()})}})}(jQuery),function(i){i.extend(zhx,{previewList:zhx.config.root.find(">div:visible").not(".move-box,.p-title,.op-list"),resetPrivewList:function(){this.previewList=zhx.config.root.find(">div:visible").not(".move-box,.p-title,.op-list"),this.resetHeight(),this.resetPluginList()},moveBox:zhx.config.root.find(".move-box"),resetHeight:function(){this.getHeightList(1),this.getTopList(1)},resetPluginList:function(){var e=[],t=[];i.each(this.previewList,function(){var a=zhx.getPluginItemIndex(i(this).attr("id"));~a&&(e.push(zhx.pluginList[a]),t.push(zhx.pluginList[a].data))}),zhx.pluginList=e,zhx.dataList=t},opBox:zhx.config.root.find(".op-list"),getEditBox:zhx.config.editRoot.find(".con-bor"),getEditList:function(){return this.getEditBox.find(">div")},activeView:function(e){var t=i(e),a=t.attr("id");t.attr("data-type");zhx.previewList.removeClass(zhx.config.editClassName),t.addClass(zhx.config.editClassName),a&&zhx.showEdit(a,t[0].offsetTop)},showSetting:function(e){var t=i("#"+e);zhx.getEditList().hide(),t.show(),this.getEditBox.show()},_elemIdxList:null,_heightList:[],_topList:[],elemList:function(){},elemListByIdx:function(){},getHeightList:function(e){if(e||!this._heightList.length){var t=[];this.previewList.each(function(){t.push(i(this).outerHeight())}),this._heightList=t}return this._heightList},getTopList:function(i){if(i||!this._topList.length){var e=[];this.previewList.each(function(){e.push(this.offsetTop)}),this._topList=e}return this._topList},moveElem:function(i,e){var t=this.previewList.index(i),a=t,l=this.getHeightList(),n=this.getTopList();n[t]>e?(a--,a>=0&&n[a]+l[a]/2>e+l[t]/2&&(this.previewList.eq(a).before(this.previewList.eq(t)),this.resetPrivewList())):(a++,a<l.length&&e+l[t]/2>n[a]+l[a]/2&&(this.previewList.eq(a).after(this.previewList.eq(t)),this.resetPrivewList()))},_shareList:[],shareMoveElem:function(e,t,a){var l=this._shareList,n=l.index(e),s=n,o=[],d=[];l.each(function(){o.push(i(this).outerHeight())}),l.each(function(){d.push(this.offsetTop)});var c=function(){zhx._shareList=e.parent("ul").find("li").not(".move-li")};d[n]>t?(s--,s>=0&&d[s]+o[s]/2>t+o[n]/2&&(l.eq(s).before(l.eq(n)),c(),a&&a())):(s++,s<o.length&&t+o[n]/2>d[s]+o[s]/2&&(l.eq(s).after(l.eq(n)),c(),a&&a()))},createOp:function(){var e=[];i.each(this.config.plugin,function(){e.push("<a data-type='"+this+"'>"+zhx.plugins[this].name+"</a>")}),this.opBox.html(e.join(" "))},addView:function(e,t){t?i(t).after(e):this.opBox.before(e)},addEditView:function(i){this.getEditBox.append(i)},resizeEditView:function(e){var t=i(e);t.attr("id");zhx.getEditBox.css("marginTop",t[0].offsetTop)}})}(jQuery),function(i){function e(i,e){var t=e||0,a=document.documentElement.clientWidth||document.documentElement.offsetWidth,l=document.documentElement.clientHeight||document.documentElement.offsetHeight;if(i){var n=(l-i.height()-t)/2;n>0?i.css({top:(l-i.height()-t)/2+"px",left:(a-i.width()-t)/2+"px"}):i.css({position:"absolute",top:(document.body.scrollTop||document.documentElement.scrollTop)+10+"px",left:(a-i.width()-t)/2+"px"})}}function t(t,a,l){t.find(".flower-close").bind("click.flower",function(){a.cancel&&a.cancel.call(this,t),a.id?t.flowerHide():t.flowerRemove()}),t.find(".box-btn-close").bind("click.flower",function(){a.cancel&&a.cancel.call(this,t),a.id?t.flowerHide():t.flowerRemove()}),t.find(".box-btn-submit").bind("click.flower",function(){a.submit&&a.submit.call(this,t)}),i(window).bind("resize.flower"+l,function(){e(t)})}zhx.box={};var a={init:null,cancel:null,submit:null,hasSubmit:!0,hasCancel:!0},l=i(".xui-shade"),n=1e4,s={box:function(i){var e=[];return e.p('<div class = "xui-flower none">'),e.p('<a class = "flower-close">x</a>'),e.p('<div class = "flower-main">'),e.p(i),e.p("</div>"),e.p("</div>"),e.join(" ")},msg:function(i){var e=[];return e.p('<div class = "art-tip-msg">'),e.p('<div class = "tip-title">'),e.p('<span class = "active">'+(i.title||"")+"</span>"),e.p("</div>"),e.p('<div class = "tip-con">'),e.p("<p>"+(i.content||"发生错误！")+"</p>"),e.p("</div>"),e.p('<div class = "btn-list">'),e.p("<p>"),i.hasSubmit&&e.p('<a class="box-btn-submit active">确认</a>'),i.hasCancel&&e.p('<a class="box-btn-close">关闭</a>'),e.p("</p>"),e.p("</div>"),e.p("</div>"),e.join(" ")}};i.fn.extend({flowerHide:function(){var e=i(this);e.attr("data-idx");return e.hide(),i(".xui-flower:visible").length||l.hide(),e},flowerRemove:function(){var e=i(this),t=e.attr("data-idx");return i(window).unbind("resize.flower"+t),e.find(".flower-close").unbind("click.flower"),e.find(".box-btn-close").unbind("click.flower"),e.find(".box-btn-submit").unbind("click.flower"),e.remove(),i(".xui-flower:visible").length||l.hide(),e}}),i.extend(zhx.box,{show:function(o,d,c){var r=i.extend({},a,{init:d},c);if(n++,r.id){var p=i("#box_"+r.id);if(p.length)return l.show(),p.show(),p}var h=i(s.box(o));return h.attr("id","box_"+r.id),h.attr("data-idx",n),l.show(),i(document.body).append(h),e(h),r.init&&r.init(h),h.show(),t(h,r,n),h},msg:function(o,d){var c=i.extend({},a,{content:o,hasCancel:!1});"function"==typeof d?i.extend(c,{submit:d}):i.extend(c,d),n++;var r=i(s.box(s.msg(c)));l.show(),i(document.body).append(r),e(r),c.init&&c.init(r),r.show();var p=c.submit;c.submit=function(){r.flowerRemove(),p&&p.call(this,r)},t(r,c,n)},confirm:function(o,d){var c=i.extend({},a,{content:o},d);n++;var r=i(s.box(s.msg(c)));l.show(),i(document.body).append(r),e(r),c.init&&c.init(r),r.show(),t(r,c,n)},showById:function(t,a){l.show();var n=i("#box_"+t);n.length?(n.show(),e(n)):a&a()}})}(jQuery),function(i){zhx.addPlugin("banner",function(){return{name:"店铺店招",isRepeat:0,isShowOp:1,isDelete:0,viewTemplate:function(){var i=[];return i.p('<div class = "ss-banner" style = "display: block">'),i.p('<div class = "mc">'),i.p('<div class="banner-bg">'),i.p('<div class="ba-logo">'),i.p('<img src = "//i0.ulecdn.com/ule/header/images/logo.png" alt = "">'),i.p("</div>"),i.p('<div class="ba-store-name">店铺名称</div>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-banner">'),i.p('<p><span>背景图片：</span><label class = "select-img">选择图片<input type="file"/></label></p>'),i.p('<p class="p-tip"><span>&nbsp;</span>最佳尺寸：640 x 200 像素。</p>'),i.p('<p class="p-tip"><span>&nbsp;</span>尺寸不匹配时，图片将被压缩或拉伸以铺满画面。</p>'),i.p('<p><span>背景颜色：</span><label class = "label-color"><input type = "color" value = "#ffffff"></label><input class = "btn-reset" type = "button" value = "重置"/></p>'),i.p('<p class="sb-logo"><span>店铺Logo：</span><img width="80" height="80"/><label class="sb-edit-logo">修改店铺Logo <input type="file"/></label></p>'),i.p("</div>"),i.join(" ")},data:{bgColor:"#F02D45",bgImgSrc:"",bgImgSize:{},logoSrc:"",storeName:"",logoSize:{}},init:function(e,t){var a=this,l=function(){a.data.bgImgSrc&&e.find(".banner-bg").css("background-image","url('"+a.data.bgImgSrc+"')")};t.find(".label-color input").bind("change",function(){e.find(".banner-bg").css("background-color",this.value),a.data.bgColor=this.value}),t.find(".btn-reset").bind("click",function(){t.find(".label-color input").val("#F02D45"),t.find(".label-color input").trigger("change")}),t.find(".select-img input").bind("change",function(){var e=this.files[0],t=i(this);zhx.data.uploadImg(e).success(function(i){0==i.status?(a.data.bgImgSrc=i.url,l(),t.text("修改")):zhx.box.msg(i.message)}).error(function(){zhx.box.msg("上传失败！")})}),t.find(".sb-edit-logo input").bind("change",function(){var i=this.files[0];zhx.data.uploadImg(i).success(function(i){0==i.status?(a.data.logoSrc=i.url,e.find(".ba-logo img").attr("src",i.url),t.find(".sb-logo img").attr("src",i.url)):zhx.box.msg(i.message)}).error(function(){zhx.box.msg("上传失败！")})})},edit:function(e){var t=i.extend({},this.data,e),a=this.viewElem,l=this.settingElem;a.find(".ba-store-name").text(t.storeName),l.find(".label-color input").val(t.bgColor),l.find(".label-color input").trigger("change"),t.bgImgSrc&&a.find(".banner-bg").css("background-image","url('"+t.bgImgSrc+"')"),t.logoSrc?(a.find(".ba-logo img").attr("src",t.logoSrc),l.find(".sb-logo img").attr("src",t.logoSrc)):zhx.config.store.storeLogo&&(this.data.logoSrc=zhx.config.store.storeLogo,a.find(".ba-logo img").attr("src",this.data.logoSrc),l.find(".sb-logo img").attr("src",this.data.logoSrc))}}})}(jQuery),function(i){zhx.addPlugin("blank",function(){return{name:"辅助空白",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "sty-blank">'),i.p('<div class = "mc"><p></p></div>'),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-blank" style="display: block">'),i.p('<p><span>空白高度：</span><label class = "label-range"><i class="i-track"></i><i class="i-thumb"></i><input type = "range"/></label>'),i.p('<label><strong class="blank-height">30</strong>像素</label>'),i.p("</p>"),i.p("</div>"),i.join(" ")},data:{height:30},init:function(i,e){var t=this,a=0;e.find(".label-range input").bind("input change",function(){e.find(".label-range .i-thumb").css({left:this.value/100*224+"px"});var l=t.data.height=parseInt(this.value/100*70+30);e.find(".blank-height").text(l),i.find("p").height(l),clearTimeout(a),a=setTimeout(function(){zhx.resetHeight()},2e3)})},edit:function(i){var e=this.settingElem,t=(i.height-30)/70*100;e.find(".label-range input").val(t).trigger("change"),e.find(".label-range input").val(t).trigger("input")}}})}(jQuery),function(i){zhx.dialog={};var e={imgListStr:function(){var i=[];return i.p('<div class = "box-img-list">'),i.p('<div class = "img-tab">'),i.p('<label class="search-img"><input type = "text" placeholder="搜索"/></label>'),i.p('<span class = "active">我的图片</span><span>图标库</span>'),i.p("</div>"),i.p('<div class = "img-con">'),i.p('<div class = "group-list">'),i.p('<p class = "active"><a>未分组</a></p>'),i.p("<p><a>未分组1</a></p>"),i.p("<p><a>未分组2</a></p>"),i.p(""),i.p("</div>"),i.p('<div class = "list">'),i.p("<ul>"),i.p("<li>"),i.p('<img src = "../images/tem/tem01.jpg"/>'),i.p("<p>順豐到付</p>"),i.p('<cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("<li>"),i.p('<img src = "../images/tem/tem03.jpg"/><p>順豐到付</p><cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("<li>"),i.p('<img src = "../images/tem/tem01.jpg"/><p>順豐到付</p><cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("<li>"),i.p('<img src = "../images/tem/tem03.jpg"/><p>順豐到付</p><cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("<li>"),i.p('<img src = "../images/tem/tem02.jpg"/><p>順豐到付</p><cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("<li>"),i.p('<img src = "../images/tem/tem04.jpg"/><p>順豐到付</p><cite class="c-bg"></cite>'),i.p('<cite class="c-txt">540*250</cite>'),i.p('<div class="img-bor">'),i.p('<i class="i-bg"></i>'),i.p('<i class="i-icon"></i>'),i.p("</div>"),i.p("</li>"),i.p("</ul>"),i.p('<p class = "state-bar">'),i.p('<a class = "link-upload">上传图片</a>'),i.p(""),i.p('<span class = "page-nubmer">'),i.p("<a>上一页</a>"),i.p("<a>1</a><a>2</a><a>3</a>"),i.p('<label><input class = "go-page" type = "text"/>/11页</label>'),i.p("<a>下一页</a>"),i.p("</span>"),i.p("<span>共3条，每页16条</span>"),i.p("</p>"),i.p("</div>"),i.p("</div>"),i.p('<div class = "btn-list">'),i.p("<a>确认</a>"),i.p("</div>"),i.p("</div>"),i.join(" ")},goodsStr:function(i){var e=[];return e.p('<div class = "box-goods-select">'),e.p('<div class = "img-tab">'),e.p('<span class = "active">已上架商品</span>'),e.p("</div>"),e.p('<div class = "img-con">'),e.p('<div class = "g-search">'),e.p("<table>"),e.p("<tr>"),e.p('<td><span>品牌：</span><label><select class="js_brand">'),e.p("<option>请选择</option>"),e.p("</select></label></td>"),e.p("<td><span>店铺分类：</span>"),e.p('<label class = "label-tree store-tree">'),e.p('<input type = "text" readonly = "readonly" placeholder = "请选择">'),e.p('<ul class = "tree-main"></ul><i class="i-close">X</i>'),e.p("</label>"),e.p("</td>"),e.p("<td><span>商品分类： </span>"),e.p('<label class = "label-tree shopping-tree">'),e.p('<input type = "text" readonly = "readonly" placeholder = "请选择">'),e.p('<ul class = "tree-main"></ul><i class="i-close">X</i>'),e.p("</label>"),e.p("</td>"),e.p("</tr>"),e.p("<tr>"),e.p('<td><span>商品id：</span><label class = "label-input"><input class="js_goods_id" type = "text"/></label></td>'),e.p('<td><span>商品名称：</span><label class = "label-input"><input  class="js_goods_name"  type = "text"/></label></td>'),e.p('<td><a class = "btn-search">查询</a></td>'),e.p("</tr>"),e.p("</table>"),e.p("</div>"),e.p('<div class = "op-tab">'),e.p('<a data-type="2">月销量</a><a data-type="3">上架时间</a><a data-type="1">价格</a>'),e.p("</div>"),e.p('<div class = "data-list">'),e.p('<table class="goods-table">'),e.p("<thead>"),e.p("<tr>"),e.p('<th width="90px"></th>'),e.p('<th width="320px">商品名称</th>'),e.p('<th width="120px">商品库存</th>'),e.p('<th width="120px">商品价格</th>'),e.p('<th><label>操作</label><input type="checkbox" id="all-goods" class="chk-all"/><label class="js_all" for="all-goods">全选</label></th>'),e.p("</tr>"),e.p("</thead>"),e.p("<tbody>"),e.p("</tbody>"),e.p("</table>"),e.p("</div>"),e.p("</div>"),e.p('<div class = "btn-list">'),e.p('<a class="btn-submit">确认</a>'),e.p('<div class="pages goods-pages">'),e.p('<span class = "page-left">'),e.p('<a class="prev">上一页</a>'),e.p('<span class = "page-nubmer">'),e.p("<a>1</a><a>2</a><a>3</a>"),e.p("</span>"),e.p('<label><input class = "go-page" type = "text"/>/<span class="sun-page">0</span>页</label>'),e.p('<a class="next">下一页</a>'),e.p("</span>"),e.p('<span>共<label class = "sun-counts">5</label>条，每页<label class = "page-size">5</label>条</span>'),e.p("</div>"),e.p("</div>"),e.p("</div>"),e.join(" ")},goodsListStr:function(){var i=[];return i.p('<div class="box-groups">'),i.p('<div class = "img-tab">'),i.p('<span class = "active">商品分组</span>'),i.p("</div>"),i.p('<div class = "img-con">'),i.p('<div class = "g-search">'),i.p("<p>选择类别</p>"),i.p("<dl>"),i.p("<dd><span>店铺分类：</span>"),i.p('<label class = "label-tree store-tree">'),i.p('<input type = "text" readonly = "readonly" placeholder = "请选择">'),i.p('<ul class = "tree-main"></ul><i class="i-close">X</i>'),i.p("</label>"),i.p("</dd>"),i.p('<dd><span>品牌：</span><label><select class="js_brand">'),i.p("<option>请选择</option>"),i.p("</select></label></d>"),i.p("<dd><span>商品分类：</span>"),i.p('<label class = "label-tree shopping-tree">'),i.p('<input type = "text" readonly = "readonly" placeholder = "请选择">'),i.p('<ul class = "tree-main"></ul><i class="i-close">X</i>'),i.p("</label>"),i.p("</dd>"),i.p("</dl>"),i.p('<p class="order-by">排序方式：<label><input type = "radio" name="orderBy" value="1" checked="checked"/>价格从低到高</label></p>'),i.p('<p class="p-orderBy"><label><input type = "radio" name="orderBy" value="2"/>月销量从高到低</label></p>'),i.p('<p class="p-orderBy"><label><input type = "radio" name="orderBy" value="3"/>按上架时间倒序</label></p>'),i.p(""),i.p("</div>"),i.p(""),i.p('<div class = "data-list">'),i.p("</div>"),i.p("</div>"),i.p('<div class = "btn-list">'),i.p('<a class="btn-submit active">确认</a>'),i.p("</div>"),i.p("</div>"),i.join(" ")},minPageStr:function(){var i=[];return i.p('<div class="box-pages">'),i.p('<div class = "img-tab">'),i.p('<span class = "active">微页面选择</span>'),i.p("</div>"),i.p('<div class = "img-con">'),i.p('<div class = "data-list">'),i.p('<table class="min-page-table">'),i.p("<thead>"),i.p("<tr>"),i.p('<th width="30%" class="td-title">标题</th>'),i.p('<th width="40%">创建时间</th>'),i.p('<th width="30%">'),i.p('<div class="search-name">'),i.p('<input type = "text"><a class="btn-search">搜</a>'),i.p("</div>"),i.p("</th>"),i.p("</tr>"),i.p("</thead>"),i.p("<tbody>"),i.p("</tbody>"),i.p("</table>"),i.p("</div>"),i.p("</div>"),i.p('<div class = "btn-list">'),i.p('<div class="pages min-pages">'),i.p('<span class = "page-left">'),i.p('<a class="prev">上一页</a>'),i.p('<span class = "page-nubmer">'),i.p("<a>1</a><a>2</a><a>3</a>"),i.p("</span>"),i.p('<label><input class = "go-page" type = "text"/>/<span class="sun-page">0</span>页</label>'),i.p('<a class="next">下一页</a>'),i.p("</span>"),i.p('<span>共<label class = "sun-counts">5</label>条，每页<label class = "page-size">5</label>条</span>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},activityStr:function(e){var t=[];return t.p('<div class="box-pages">'),t.p('<div class = "img-tab">'),t.p('<span class = "active">活动</span>'),t.p("</div>"),t.p('<div class = "img-con">'),t.p('<div class = "data-list">'),t.p("<table>"),t.p("<thead>"),t.p("<tr>"),t.p('<th width="30%" class="td-title">标题</th>'),t.p('<th width="40%">有效时间</th>'),t.p('<th width="30%">'),t.p('<div class="search-name">'),t.p('<input type = "text"><a>搜</a>'),t.p("</div>"),t.p("</th>"),t.p("</tr>"),t.p("</thead>"),t.p("<tbody>"),i.each(e,function(){t.p("<tr>"),t.p('<td class="td-title"><a target="_blank">'+this.name+"</a></td>"),t.p("<td>2017-1-1 16:44:33 - 2017-1-2 16:44:33</td>"),t.p('<td><a class="btn-select">选择</a></td>'),t.p("</tr>")}),t.p("</tbody>"),t.p("</table>"),t.p("</div>"),t.p("</div>"),t.p('<div class = "btn-list">'),t.p("<span>共3条，每页5条</span>"),t.p("</div>"),t.p("</div>"),t.join(" ")}};i.extend(zhx.dialog,{imgList:function(t,a){zhx.box.show(e.imgListStr(),function(e){var l,n=e.find(".btn-list a"),s=e.find(".group-list p");s.bind("click",function(){zhx.tabChangeClass(s,i(this),zhx.ac)});var o=function(){var t=e.find(".list li");a?t.bind("click",function(){var a=i(this);zhx.tabChangeClass(t,a),l=e.find(".list ul .active"),n.toggleClass(zhx.ac,!!l.length)}):t.bind("click",function(){var t=i(this);t.toggleClass(zhx.ac),l=e.find(".list ul .active"),n.toggleClass(zhx.ac,!!l.length)})};o(),n.bind("click",function(){n.hasClass(zhx.ac)&&(t&&t.call(e,l),e.flowerHide())})})},selectGoods:function(t,a,l){var n=zhx.data.getBaseInfo();zhx.box.show(e.goodsStr([]),function(e){var s=(e.find(".btn-select"),e.find(".btn-submit")),o=e.find(".chk-all"),d=[],c={},r=[];a&&(e.find(".btn-submit").hide(),e.find(".chk-all").hide(),e.find(".js_all").hide());var p=e.find(".goods-pages").flowerPage({pageSize:5}),h={microshoppId:zhx.config.store.id},u=function(e){var t=!1;return l&&l.length&&i.each(l,function(){this.listingId==e&&(t=!0)}),t};p.jsonp(zhx.data.host+"/api/finding/v1/listings?pageIndex={pageIndex}&pageSize={pageSize}",h,function(t,a){if(t.result){r=t.result.listingList||[];
var l=[];a.listCount=t.result.totalNum||0,r&&r.length?i.each(r,function(){l.p("<tr>"),l.p('<td class="td-img">'),l.p('<img src = "'+this.imgUrl+'"/></td>'),l.p('<td class="td-title"><a target="_blank" href="'+this.listingUrl+'">'+this.listingName+"</a></td>"),l.p("<td>"+this.storage+"</td>"),l.p("<td>¥"+this.salePrice+"</td>"),c[this.listingId]||u(this.listingId)?(l.p('<td><a class="btn-select active">取消</a></td>'),c[this.listingId]=this):l.p('<td><a class="btn-select">选择</a></td>'),l.p("</tr>")}):l.p('<tr><td colspan="5" height="100">未找到数据！</td></tr>'),e.find(".goods-table tbody").html(l.join(" ")),b()}});var f=function(t){var a={brandId:i.trim(e.find(".js_brand").val()),storeCategroyId:e.find(".store-tree").attr("data-val"),categroyId:e.find(".shopping-tree").attr("data-val"),listingIds:e.find(".js_goods_id").val(),listingName:e.find(".js_goods_name").val(),orderType:t||""};for(var l in a)a.hasOwnProperty(l)&&(a[l]||delete a[l]);return i.extend({},h,a)};e.find(".btn-search").bind("click",function(){p.config({data:f()}),p.reset()}),e.find(".op-tab a").bind("click",function(){var t=i(this),a=t.attr("data-type"),l="";1==a?l="up":2!=a&&3!=a||(l="down"),t.hasClass(l)?(e.find(".op-tab a").removeClass("up down"),t.removeClass(l),a=0):(e.find(".op-tab a").removeClass("up down"),t.addClass(l)),p.config({data:f(a)}),p.reset()});var b=function(){d=[],i.each(c,function(i,e){d.p(e)}),d.length?s.addClass(zhx.ac):s.removeClass(zhx.ac)};e.find(".goods-table").bind("click",function(l){if("A"==l.target.nodeName){var n=i(l.target);if(n.hasClass("btn-select")){var s=e.find(".btn-select").index(n),o=r[s];if(a)o.typeName="商品",o.name=o.listingName,o.src=o.listingUrl,t&&t.call(e,o),e.flowerRemove();else{var d=n.hasClass(zhx.ac);n.text(d?"选择":"取消"),d?(n.removeClass(zhx.ac),c[o.listingId]&&delete c[o.listingId]):(n.addClass(zhx.ac),c[o.listingId]||(c[o.listingId]=o))}b()}}}),o.bind("click",function(){var t=this.checked;t?i.each(e.find(".btn-select"),function(){i(this).hasClass(zhx.ac)||i(this).trigger("click")}):i.each(e.find(".btn-select"),function(){i(this).hasClass(zhx.ac)&&i(this).trigger("click")})}),n.then(function(i){var t=i.storeCategoryList;e.find(".store-tree").tree({list:t,nextStr:"children",idStr:"storeCategoryId",nameStr:"categoryName"})}),n.then(function(i){var t=i.categroyList;e.find(".shopping-tree").tree({list:t,nextStr:"children",idStr:"categoryId",nameStr:"name"})}),n.then(function(t){var a=['<option value=" ">请选择</option>'];i.each(t.brandList,function(){a.p('<option value="'+this.brandId+'">'+this.brandName+"</option>")}),e.find(".js_brand").html(a.join(" "))}),s.bind("click",function(){s.hasClass(zhx.ac)&&(t&&t.call(e,d),e.flowerRemove())})})},selectGoodsSingleton:function(i){this.selectGoods(i,!0)},selectGroup:function(t){var a=[{id:1,name:"日常用品"},{id:2,name:"推荐商品"},{id:3,name:"服装商品"}];zhx.box.show(e.goodsListStr(a),function(e){var l=e.find(".btn-select"),n=e.find(".btn-submit"),s=[],o={};l.bind("click",function(){var e=l.index(this),t=a[e],d=i(this),c=d.hasClass(zhx.ac);d.text(c?"选择":"取消"),c?(d.removeClass(zhx.ac),o[t.id]&&delete o[t.id]):(d.addClass(zhx.ac),o[t.id]||(o[t.id]=t)),s=[],i.each(o,function(i,e){s.p(e)}),s.length?n.addClass(zhx.ac):n.removeClass(zhx.ac)}),n.bind("click",function(){n.hasClass(zhx.ac)&&(t&&t.call(e,s),e.flowerHide())})})},selectGroupSingleton:function(t){var a=zhx.data.getBaseInfo();zhx.box.show(e.goodsListStr([]),function(e){a.then(function(i){var t=i.storeCategoryList;e.find(".store-tree").tree({list:t,nextStr:"children",idStr:"storeCategoryId",nameStr:"categoryName"})}),a.then(function(i){var t=i.categroyList;e.find(".shopping-tree").tree({list:t,nextStr:"children",idStr:"categoryId",nameStr:"name"})}),a.then(function(t){var a=['<option value=" ">请选择</option>'];i.each(t.brandList,function(){a.p('<option value="'+this.brandId+'">'+this.brandName+"</option>")}),e.find(".js_brand").html(a.join(" "))});var l=function(){var t={brandId:i.trim(e.find(".js_brand").val()),storeCategroyId:e.find(".store-tree").attr("data-val"),categroyId:e.find(".shopping-tree").attr("data-val"),orderType:e.find("input[type='radio']:checked").val()};for(var a in t)t.hasOwnProperty(a)&&(t[a]||delete t[a]);return t};e.find(".btn-submit").bind("click",function(){t&&t.call(e,l()),e.flowerHide()})})},selectMinPage:function(t){zhx.box.show(e.minPageStr(),function(e){var a=[],l=e.find(".min-pages").flowerPage({pageSize:5}),n=function(){return{searchTitle:i.trim(e.find(".search-name input").val())}},s=n();l.jsonp(zhx.config.store.basePath+"/api/v1/page/queryByForPage?pageIndex={pageIndex}&pageSize={pageSize}",s,function(t,l){var n=[];t.pageDtoPage&&t.pageDtoPage.result?(a=t.pageDtoPage.result||[],l.listCount=t.pageDtoPage.totalRecords||0,a&&i.each(a,function(){n.p("<tr>"),n.p('<td class="td-title"><a target="_blank">'+this.pageTitle+"</a></td>"),n.p("<td>"+new Date(this.createTime).format("yyyy-MM-dd")+"</td>"),n.p('<td><a class="btn-select">选择</a></td>'),n.p("</tr>")})):n.p('<tr><td colspan="3" height="100">未找到数据！</td></tr>'),e.find(".min-page-table tbody").html(n.join(" "))}),e.find(".min-page-table").bind("click",function(l){if("A"==l.target.nodeName){var n=i(l.target);if(n.hasClass("btn-select")){var s=e.find(".btn-select").index(n),o=a[s];o.typeName="微页面",o.name=o.pageTitle,o.src=o.pageUrl,t&&t.call(e,o),e.flowerHide()}}}),e.find(".search-name a").bind("click",function(){l.config({data:n()}),l.reset()})})},selectActivity:function(i){var t=[{name:"活动1"},{name:"活动2"},{name:"活动3"}];zhx.box.show(e.activityStr(t),function(e){var a=e.find(".btn-select");a.bind("click",function(){var l=a.index(this);i&&i.call(e,{typeName:"营销活动",name:t[l].name,src:l}),e.flowerHide()})})}})}(jQuery),function(i){zhx.addPlugin("editor",function(){return{name:"富文本",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "sty-editor">'),i.p('<div class = "mc"><div class="ed-main-txt">点击编辑"富文本"内容</div></div>'),i.p("</div>"),i.join(" ")},settingTemplate:function(i){var e=[];return e.p('<div class = "set-sty-editor" style="display: block">'),e.p('<p><span class="sp-label">颜色：</span><label class = "label-color"><input type = "color" value = "#ffffff"></label><input class="btn-reset" type="button" value="重置"/>'),e.p('<label class="label-checkbox"><input type="checkbox"/>全屏显示<i class = "i-icon"></i></label>'),e.p("</p>"),i.editorId=(new Date).getTime()+100,e.p('<script id="editor_'+i.editorId+'" type="text/plain"></script>'),e.p("</div>"),e.join(" ")},data:{editorId:"",html:"",isFull:!1,bgColor:"#ffffff"},init:function(e,t){var a=this,l=UE.getEditor("editor_"+this.data.editorId,{initialFrameWidth:"400",initialFrameHeight:"300"});l.addListener("contentChange",function(){a.data.html=l.getContent(),e.find(".ed-main-txt").html(a.data.html)}),l.addListener("ready",function(i){}),t.find(".label-color input").bind("change",function(){e.find(".mc").css("background-color",this.value),a.data.bgColor=this.value}),t.find(".btn-reset").bind("click",function(){t.find(".label-color input").val("#ffffff"),t.find(".label-color input").trigger("change")}),zhx.other.checkbox(t.find(".label-checkbox"),function(){var t=i(this).prop("checked");e.find(".mc").toggleClass("full",!!t),a.data.isFull=t})},edit:function(e){var t=i.extend(this.data,e),a=this.settingElem,l=UE.getEditor("editor_"+t.editorId);l.addListener("ready",function(){l.setContent(t.html)}),t.isFull&&a.find(".label-checkbox").trigger("click"),a.find(".label-color input").val(t.bgColor).trigger("change")},destroy:function(){UE.getEditor("editor_"+this.data.editorId).destroy()}}})}(jQuery),function(i){zhx.addPlugin("enterStore",function(){return{name:"进入店铺",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "se-store">'),i.p('<div class = "mc"><p><a href=""><i class="i-icon"></i><i class="i-right"></i><label>'+(zhx.config.store.name||"店铺名称")+"</label><span>进入店铺</span></a></p></div>"),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-se-store" style="display: block">'),i.p("<p>进入店铺</p>"),i.p("</div>"),i.join(" ")},data:{},init:function(i,e){},edit:function(i){}}})}(jQuery),function(i){zhx.addPlugin("goods",function(){return{name:"商品",isDelete:1,isRepeat:1,isShowOp:1,def:{imgList:[{listingName:"商品1",imgUrl_s:zhx.config.imgroot+"goods_bg_01.jpg",minPrice:70,p2:65},{listingName:"商品2",imgUrl_s:zhx.config.imgroot+"goods_bg_02.jpg",minPrice:240,p2:225},{listingName:"商品3",imgUrl_s:zhx.config.imgroot+"goods_bg_03.jpg",minPrice:170,p2:165},{listingName:"商品4",imgUrl_s:zhx.config.imgroot+"goods_bg_04.jpg",minPrice:100,p2:80}],listClass:{big:"goods-big",small:"goods-small",bigAndSmall:"goods-big-small",detail:"goods-detail"},listStyle:{card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"},detailClass:{big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},detailStyle:this.listStyle,buyClass:["buy-none","buy-1","buy-2","buy-3","buy-4"]},viewTemplate:function(){var i=[];return i.p('<div class = "goods-list goods-big" style="display: block">'),i.p('<div class = "mc">'),i.p('<ul class="ul-1 clearfix card buy-4">'),i.p("</ul>"),i.p('<ul class="ul-2 clearfix card buy-4">'),i.p("</ul>"),i.p("</div>"),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-goods-list set-goods">'),i.p('<div class="sel-list clearfix"><span>选择商品：</span>'),i.p('<ul class="good-rew-list clearfix">'),i.p('<li class="li-add"><a class="btn-add-goods"><i></i></a></li>'),i.p("</ul>"),i.p("</div>"),i.p('<p class="list-style"><span>列表样式：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "listStyle" value = "big" checked = "checked"/>大图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "small"/>小图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "bigAndSmall"/>一大两小<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "detail"/>详细列表<i class = "i-icon"></i></label>'),i.p("</p>"),i.p(""),i.p('<div class = "detail-info dta-big">'),i.p('<p class="show-type"><label class = "label-radio label-radio-active"><input type = "radio" name = "cardStyle" value = "card" checked = "checked"/>卡片样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "waterfall"/>瀑布流<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "simple"/>极简样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "promotion"/>促销<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<div class = "style-detail card">'),i.p('<p class="buy-chk"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showBuy" checked="checked"/>显示购买按钮<i class = "i-icon"></i></label></p>'),i.p('<p class="buy-btn-style">'),i.p('<label class = "label-radio "><input type = "radio" value = "1" name = "buyStyle"/>样式1<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "2"/>样式2<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "3"/>样式3<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" checked = "checked" name = "buyStyle" value = "4"/>样式4<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p class="show-name"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showName" checked="checked"/>显示商品名 <strong class="dta-tip">(小图不显示名称)</strong><i class = "i-icon"></i></label></p>'),i.p('<p class="show-price"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showPrice" checked="checked"/>显示价格<i class = "i-icon"></i></label></p>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},minGoodsStr:function(e){var t=[];return i.each(e,function(){t.p('<li ><a><img src="'+this.imgUrl_m+'"/><i class="i-close" data-id="'+this.categoryId+'">x</i></a></li>')}),t.join(" ")},data:{num:0,goodsList:[],pattern:"big",type:"card",showBuy:1,showName:1,showPrice:1,buyStyle:4},init:function(e,t){var a=this,l=(e.find("ul"),t.find(".label-radio")),n={card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"},s={big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},o=n,d=t.find(".detail-info"),c=t.find(".style-detail");zhx.other.radio(l,function(l,n,r){switch(l){case"listStyle":a.data.pattern=n,zhx.changeClass(d,s,n),t.find(".show-type .label-radio-active").is(":hidden")&&t.find(".show-type .label-radio").eq(0).trigger("click");break;case"cardStyle":a.data.type=n,zhx.changeClass(c,o,n),"detail"==a.data.pattern&&"simple"==n&&3==a.data.buyStyle&&t.find(".buy-btn-style .label-radio").eq(0).trigger("click"),a.addGoodsListHtml();break;case"buyStyle":a.data.buyStyle=n}r.isTrigger||a.resetHtml(a.data),e.find(".mc p").css("border-bottom-style",i(this).val())});var r=t.find(".label-checkbox"),p=(t.find(".buy-chk"),t.find(".buy-btn-style"));zhx.other.checkbox(r,function(i,e,t){switch(i){case"showBuy":a.data.showBuy=e,e?a.data.buyStyle=p.find(".label-radio-active input").val():a.data.buyStyle=0,p.toggleClass("none",!e);break;case"showName":a.data.showName=e;break;case"showPrice":a.data.showPrice=e}t.isTrigger||a.resetHtml(a.data)}),t.find(".btn-add-goods").bind("click",function(){zhx.dialog.selectGoods(function(i){if(i&&i.length){a.data.goodsList.length=0,Array.prototype.push.apply(a.data.goodsList,i);var e=a.minGoodsStr(i);t.find(".good-rew-list li").not(".li-add").remove(),t.find(".li-add").before(e)}else a.data.goodsList=[];a.addGoodsListHtml(),a.resetHtml(a.data)},!1,a.data.goodsList)}),t.find(".good-rew-list").bind("click",function(t){if("I"==t.target.nodeName){var l=i(t.target),n=i(this);if(l.hasClass("i-close")){var s=n.find(".i-close").index(l);a.removeGoods(l.attr("data-id")),n.find("li").eq(s).remove(),a.data.goodsList.splice(s,1),e.find("li").eq(s).remove(),a.addGoodsListHtml()}}}),a.addGoodsListHtml(),a.resetHtml(a.data)},addGoodsListHtml:function(){var e="waterfall"==this.data.type,t=this.data.goodsList;t&&t.length||(t=this.def.imgList);var a=[],l=[],n=function(i,e){var t=[];return t.p('<li class="li-'+(e+1)+'">'),t.p('<a  class = "goods-img " href = "">'),t.p('<img src = "'+(i.imgUrl_xl||i.imgUrl_s)+'">'),t.p("</a>"),t.p('<div class = "info-box">'),t.p('<p class="goods-name" href = ""><a>'+i.listingName+"</a></p>"),t.p('<p class="goods-price">¥'+i.minPrice+"</p>"),t.p('<a class="btn-buy" href = "">订购</a>'),t.p("</div>"),t.p('<div class = "promotion-box none">'),t.p('<div class = "prom-price">'),t.p("<strong>¥"+i.minPrice+"</strong>"),t.p("<del>原价：¥"+(i.maxPrice||"")+"</del>"),t.p("</div>"),t.p('<a class = "btn-prom" href = "" data-id="'+i.listingId+'">我要抢购</a>'),t.p("</div>"),t.p("</li>"),t};i.each(t,function(i){e&&i%2?Array.prototype.push.apply(l,n(this,i)):Array.prototype.push.apply(a,n(this,i))}),e?(this.viewElem.find(".ul-1").html(a.join(" ")),this.viewElem.find(".ul-2").html(l.join(" ")).show()):(this.viewElem.find(".ul-1").html(a.join(" ")),this.viewElem.find(".ul-2").hide())},removeGoods:function(e){var t=this;i.each(this.data.goodsList,function(i){this.id==e&&t.data.goodsList.splice(i,1)})},resetHtml:function(i){var e=this,t=function(){var t=this.viewElem,a=(this.settingElem,t.find(".mc")),l=t.find("ul"),n=i;zhx.changeClass(t,this.def.listClass,n.pattern),zhx.changeClass(a.find("ul"),this.def.listStyle,n.type),zhx.changeClass(l,e.def.buyClass,n.buyStyle),"waterfall"==e.data.type&&(a.find(".info-box").toggleClass("pos-box",!e.data.showName&&!e.data.showPrice&&e.data.showBuy),a.find(".info-box").toggleClass("h-none",!e.data.showName&&!e.data.showPrice&&e.data.showBuy)),a.find(".goods-name").toggleClass("none",!n.showName),a.find(".goods-price").toggleClass("none",!n.showPrice),zhx.resetHeight()};requestAnimationFrame(function(){t.apply(e)})},resetSetting:function(i){var e=this,t=function(){var e=(this.viewElem,this.settingElem),t=i,a=["big","small","bigAndSmall","detail"],l=a.indexOf(t.pattern);~l||(l=0),zhx.changeClass(e.find(".detail-info"),this.def.detailClass,t.pattern),e.find(".list-style .label-radio").eq(l).trigger("click");var n=["card","waterfall","simple","promotion"],s=n.indexOf(t.type);~s||(s=0),e.find(".show-type .label-radio").eq(s).trigger("click"),zhx.other.activeCheck(e.find(".buy-chk label"),!!t.showBuy),e.find(".buy-btn-style").toggleClass("none",!t.showBuy),t.buyStyle&&e.find(".buy-btn-style .label-radio").eq(t.buyStyle-1).trigger("click"),zhx.other.activeCheck(e.find(".show-name label"),!!t.showName),zhx.other.activeCheck(e.find(".show-price label"),!!t.showPrice)};requestAnimationFrame(function(){t.apply(e)})},edit:function(i){var e=this;this.resetHtml(i),this.resetSetting(i);var t=(this.viewElem,this.settingElem),a={listingIds:i.itemIds.join(",")};zhx.data.getGoods(a).then(function(i){var a=i.listingList;if(a&&a.length){e.data.goodsList.length=0,Array.prototype.push.apply(e.data.goodsList,a);var l=e.minGoodsStr(a);t.find(".good-rew-list li").not(".li-add").remove(),t.find(".li-add").before(l)}else e.data.goodsList=[];e.addGoodsListHtml(),e.resetHtml(e.data)})}}})}(jQuery),function(i){zhx.addPlugin("goodsGroup",function(){return{name:"商品分组",isDelete:1,isRepeat:1,isShowOp:1,def:{imgList:[{listingName:"商品1",imgUrl_s:zhx.config.imgroot+"goods_bg_01.jpg",salePrice:70,p2:65},{listingName:"商品2",imgUrl_s:zhx.config.imgroot+"goods_bg_02.jpg",salePrice:240,p2:225},{listingName:"商品3",imgUrl_s:zhx.config.imgroot+"goods_bg_03.jpg",salePrice:170,p2:165},{listingName:"商品4",imgUrl_s:zhx.config.imgroot+"goods_bg_04.jpg",salePrice:100,p2:80}],listClass:{big:"goods-big",small:"goods-small",bigAndSmall:"goods-big-small",detail:"goods-detail"},listStyle:{card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"},detailClass:{big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},detailStyle:this.listStyle,buyClass:["buy-none","buy-1","buy-2","buy-3","buy-4"]},viewTemplate:function(){var e=[];return e.p('<div class = "goods-list goods-big" style="display: block">'),e.p('<div class = "mc">'),e.p('<div class="group group-1 clearfix">'),e.p('<div class="group-nav">'),e.p("<ol>"),e.p('<li class="active"><a>分组1</a></li>'),e.p("<li><a>分组2</a></li>"),e.p("<li><a>分组3</a></li>"),e.p("<li><a>分组4</a></li>"),e.p("</ol>"),e.p("</div>"),e.p('<div class="group-con">'),e.p("<ol>"),i.each(this.def.imgList,function(){e.p("<li>"),e.p('<img src = "'+(this.imgUrl_xl||this.imgUrl_s)+'">'),e.p('<div class="text-con">'),e.p("<p><a>商品名称</a></p>"),e.p("<p><em>¥120.00</em></p>"),e.p('<i class="btn-buy"></i>'),e.p("</div>"),e.p("</li>")}),e.p("</ol>"),e.p("</div>"),e.p("</div>"),e.p('<div class = "group group-2">'),e.p('<ul class="clearfix card buy-4">'),i.each(this.def.imgList,function(i){e.p('<li class="li-'+(i+1)+'">'),e.p('<a  class = "goods-img " href = "">'),e.p('<img src = "'+(this.imgUrl_xl||this.imgUrl_s)+'">'),e.p("</a>"),e.p('<div class = "info-box">'),e.p('<p class="goods-name" href = ""><a>商品名称</a></p>'),e.p('<p class="goods-price">¥'+this.p2+"</p>"),e.p('<a class="btn-buy" href = "">订购</a>'),e.p("</div>"),e.p('<div class = "promotion-box none">'),e.p('<div class = "prom-price">'),e.p("<strong>¥"+this.p2+"</strong>"),e.p("<del>原价：¥"+this.p1+"</del>"),e.p("</div>"),e.p('<a class = "btn-prom" href = "">我要抢购</a>'),e.p("</div>"),e.p("</li>")}),e.p("</ul>"),e.p("</div>"),e.p("</div>"),e.p("</div>"),e.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-goods-list set-goods-group">'),i.p('<p class="show-view"><span>商品分组模板：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "viewType" value = "list" checked = "checked"/>左侧菜单 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "viewType" value = "group"/>顶部菜单<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<div class="set-group-1">'),i.p('<p class="nav-link"><a><i></i>添加商品分组</a></p>'),i.p('<p class="r-tip"><label>选择商品来源后，左侧实时预览暂不支持显示其包含的商品数据</label></p>'),i.p("</div>"),i.p('<div class="set-group-2">'),i.p('<p class="nav-link"><a><i></i>添加商品分组</a></p>'),i.p('<p class="r-tip"><label>选择商品来源后，左侧实时预览暂不支持显示其包含的商品数据</label></p>'),i.p(""),i.p('<p class="list-style"><span>列表样式：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "listStyle" value = "big" checked = "checked"/>大图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "small"/>小图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "bigAndSmall"/>一大两小<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "detail"/>详细列表<i class = "i-icon"></i></label>'),i.p("</p>"),i.p(""),i.p('<div class = "detail-info dta-big">'),i.p('<p class="show-type"><label class = "label-radio label-radio-active"><input type = "radio" name = "cardStyle" value = "card" checked = "checked"/>卡片样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "waterfall"/>瀑布流<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "simple"/>极简样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "promotion"/>促销<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<div class = "style-detail card">'),i.p('<p class="buy-chk"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showBuy" checked="checked"/>显示购买按钮<i class = "i-icon"></i></label></p>'),i.p('<p class="buy-btn-style">'),i.p('<label class = "label-radio "><input type = "radio" value = "1" name = "buyStyle"/>样式1<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "2"/>样式2<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "3"/>样式3<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "buyStyle" value = "4"  checked = "checked"/>样式4<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p class="show-name"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showName" checked="checked"/>显示商品名 <i class = "i-icon"></i></label></p>'),i.p('<p class="show-price"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showPrice" checked="checked"/>显示价格<i class = "i-icon"></i></label></p>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},data:{viewType:"list",pattern:"detail",type:"card",showBuy:1,showName:1,showPrice:1,buyStyle:4},init:function(e,t){var a=this,l=(e.find("ul"),t.find(".label-radio"));t.find(".nav-link").bind("click",function(){zhx.dialog.selectGroup(function(i){console.log(i)})});var n={card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"},s={big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},o=n,d=t.find(".detail-info"),c=t.find(".style-detail");zhx.other.radio(l,function(l,n,r){switch(l){case"viewType":a.data.viewType=n,"list"==n?(e.find(".group-1").show(),e.find(".group-2").hide(),t.find(".set-group-1").show(),t.find(".set-group-2").hide()):(e.find(".group-1").hide(),e.find(".group-2").show(),t.find(".set-group-1").hide(),t.find(".set-group-2").show());break;case"listStyle":a.data.pattern=n,zhx.changeClass(d,s,n),zhx.resetHeight(),t.find(".show-type .label-radio-active").is(":hidden")&&t.find(".show-type .label-radio").eq(0).trigger("click");break;case"cardStyle":a.data.type=n,zhx.changeClass(c,o,n),"detail"==a.data.pattern&&"simple"==n&&3==a.data.buyStyle&&t.find(".buy-btn-style .label-radio").eq(0).trigger("click"),a.addGoodsListHtml();break;case"buyStyle":a.data.buyStyle=n}r.isTrigger||a.resetHtml(a.data),e.find(".mc p").css("border-bottom-style",i(this).val())});var r=t.find(".label-checkbox"),p=(t.find(".buy-chk"),t.find(".buy-btn-style"));zhx.other.checkbox(r,function(i,e,t){switch(i){case"showBuy":a.data.showBuy=e,e?a.data.buyStyle=p.find("input:checked").val():a.data.buyStyle=0,p.toggleClass("none",!e);break;case"showName":a.data.showName=e;break;case"showPrice":a.data.showPrice=e}t.isTrigger||a.resetHtml(a.data)})},addGoodsListHtml:function(){var e="waterfall"==this.data.type,t=this.data.goodsList;t&&t.length||(t=this.def.imgList);var a=[],l=[],n=function(i,e){var t=[];return t.p('<li class="li-'+(e+1)+'">'),t.p('<a  class = "goods-img " href = "">'),t.p('<img src = "'+(i.imgUrl_xl||i.imgUrl_s)+'">'),t.p("</a>"),t.p('<div class = "info-box">'),t.p('<p class="goods-name" href = ""><a>'+i.listingName+"</a></p>"),t.p('<p class="goods-price">¥'+i.salePrice+"</p>"),t.p('<a class="btn-buy" href = "">订购</a>'),t.p("</div>"),t.p('<div class = "promotion-box none">'),t.p('<div class = "prom-price">'),t.p("<strong>¥"+i.salePrice+"</strong>"),t.p("<del>原价：¥"+(i.p1||"")+"</del>"),t.p("</div>"),t.p('<a class = "btn-prom" href = "" data-id="'+i.listingId+'">我要抢购</a>'),t.p("</div>"),t.p("</li>"),t};i.each(t,function(i){e&&i%2?Array.prototype.push.apply(l,n(this,i)):Array.prototype.push.apply(a,n(this,i))}),e?(this.viewElem.find(".ul-1").html(a.join(" ")),this.viewElem.find(".ul-2").html(l.join(" ")).show()):(this.viewElem.find(".ul-1").html(a.join(" ")),this.viewElem.find(".ul-2").hide())},removeGoods:function(e){var t=this;i.each(this.data.goodsList,function(i){this.id==e&&t.data.goodsList.splice(i,1)})},resetHtml:function(i){var e=this,t=function(){var t=this.viewElem,a=(this.settingElem,t.find(".mc")),l=t.find("ul"),n=i;zhx.changeClass(t,this.def.listClass,n.pattern),zhx.changeClass(a.find("ul"),this.def.listStyle,n.type),zhx.changeClass(l,e.def.buyClass,n.buyStyle),"waterfall"==e.data.type&&(a.find(".info-box").toggleClass("pos-box",!e.data.showName&&!e.data.showPrice&&e.data.showBuy),a.find(".info-box").toggleClass("h-none",!e.data.showName&&!e.data.showPrice&&e.data.showBuy)),a.find(".goods-name").toggleClass("none",!n.showName),a.find(".goods-price").toggleClass("none",!n.showPrice)};requestAnimationFrame(function(){t.apply(e)})},resetSetting:function(e){var t=this,a=function(){var t=(this.viewElem,this.settingElem),a=i.extend(this.data,e),l=["big","small","bigAndSmall","detail"],n=l.indexOf(a.pattern);~n||(n=0),zhx.changeClass(t.find(".detail-info"),this.def.detailClass,a.pattern),t.find(".list-style .label-radio").eq(n).trigger("click"),zhx.other.activeCheck(t.find(".buy-chk label"),!!a.showBuy),t.find(".buy-btn-style .label-radio").eq(a.showBuy).trigger("click")};requestAnimationFrame(function(){a.apply(t)})},edit:function(e){var t=this;this.resetHtml(e),this.resetSetting(e);var a={listings:e.itemIds.join(",")};zhx.data.getGoods(a).then(function(e){var a=e.listingList;if(a&&a.length){Array.prototype.push.apply(t.data.goodsList,a);var l=t.minGoodsStr(a);i(".li-add").before(l)}else t.data.goodsList=[];t.addGoodsListHtml(),t.resetHtml(t.data)})}}})}(jQuery),function(i){zhx.addPlugin("goodsList",function(){return{name:"商品列表",isDelete:1,isRepeat:1,isShowOp:1,def:{imgList:[{listingName:"商品1",imgUrl_s:zhx.config.imgroot+"goods_bg_01.jpg",minPrice:70,p2:65},{listingName:"商品2",imgUrl_s:zhx.config.imgroot+"goods_bg_02.jpg",minPrice:240,p2:225},{listingName:"商品3",imgUrl_s:zhx.config.imgroot+"goods_bg_03.jpg",minPrice:170,p2:165},{listingName:"商品4",imgUrl_s:zhx.config.imgroot+"goods_bg_04.jpg",minPrice:100,p2:80}],listClass:{big:"goods-big",small:"goods-small",bigAndSmall:"goods-big-small",detail:"goods-detail"},listStyle:{card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"},detailClass:{big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},detailStyle:this.listStyle,buyClass:["buy-none","buy-1","buy-2","buy-3","buy-4"]},viewTemplate:function(){var i=[];return i.p('<div class = "goods-list goods-big" style="display: block">'),i.p('<div class = "mc">'),i.p('<ul class="ul-1 clearfix card buy-4">'),i.p("</ul>"),i.p('<ul class="ul-2 clearfix card buy-4">'),i.p("</ul>"),i.p("</div>"),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-goods-list">'),i.p('<p class="r-list"><span>商品来源：</span><label><em></em></label><a>选择商品来源</a></p>'),i.p('<p class="r-tip"><span></span><label>选择商品来源后，左侧实时预览暂不支持显示其包含的商品数据</label></p>'),i.p('<p class="show-num"><span>显示个数：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "g_showNum" value = "6" checked = "checked"/>6 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "g_showNum" value = "12"/>12<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "g_showNum" value = "18"/>18 <i class = "i-icon"></i></label>'),i.p("</p>"),i.p(""),i.p('<p class="list-style"><span>列表样式：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "listStyle" value = "big" checked = "checked"/>大图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "small"/>小图<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "bigAndSmall"/>一大两小<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "listStyle" value = "detail"/>详细列表<i class = "i-icon"></i></label>'),i.p("</p>"),i.p(""),i.p('<div class = "detail-info dta-big">'),i.p('<p class="show-type"><label class = "label-radio label-radio-active"><input type = "radio" name = "cardStyle" value = "card" checked = "checked"/>卡片样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "waterfall"/>瀑布流<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "simple"/>极简样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "cardStyle" value = "promotion"/>促销<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<div class = "style-detail card">'),i.p('<p class="buy-chk"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showBuy" checked="checked"/>显示购买按钮<i class = "i-icon"></i></label></p>'),i.p('<p class="buy-btn-style">'),i.p('<label class = "label-radio "><input type = "radio" value = "1" name = "buyStyle"/>样式1<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "2"/>样式2<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "buyStyle" value = "3"/>样式3<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" name = "buyStyle" value = "4"  checked = "checked"/>样式4<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p class="show-name"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showName" checked="checked"/>显示商品名  <strong class="dta-tip">(小图不显示名称)</strong><i class = "i-icon"></i></label></p>'),i.p('<p class="show-price"><label class = "label-checkbox label-checkbox-active"><input type = "checkbox" name="showPrice" checked="checked"/>显示价格<i class = "i-icon"></i></label></p>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},data:{num:6,goodsList:[],pattern:"big",type:"card",showBuy:1,showName:1,showPrice:1,buyStyle:4,searchData:{}},init:function(e,t){var a=this,l=(e.find("ul"),t.find(".label-radio")),n={card:"card",waterfall:"waterfall",simple:"simple",promotion:"promotion"
},s={big:"dta-big",small:"dta-small",bigAndSmall:"dta-bs",detail:"dta-list"},o=n,d=t.find(".detail-info"),c=t.find(".style-detail");zhx.other.radio(l,function(l,n,r){switch(l){case"g_showNum":a.data.num=n,a.addGoodsListHtml(),a.resetHtml(a.data);break;case"listStyle":a.data.pattern=n,zhx.changeClass(d,s,n),t.find(".show-type .label-radio-active").is(":hidden")&&t.find(".show-type .label-radio").eq(0).trigger("click");break;case"cardStyle":a.data.type=n,zhx.changeClass(c,o,n),"detail"==a.data.pattern&&"simple"==n&&3==a.data.buyStyle&&t.find(".buy-btn-style .label-radio").eq(0).trigger("click"),a.addGoodsListHtml();break;case"buyStyle":a.data.buyStyle=n}r.isTrigger||a.resetHtml(a.data),e.find(".mc p").css("border-bottom-style",i(this).val())});var r=t.find(".label-checkbox"),p=(t.find(".buy-chk"),t.find(".buy-btn-style"));zhx.other.checkbox(r,function(i,e,t){switch(i){case"showBuy":a.data.showBuy=e,e?a.data.buyStyle=p.find(".label-radio-active input").val():a.data.buyStyle=0,p.toggleClass("none",!e);break;case"showName":a.data.showName=e;break;case"showPrice":a.data.showPrice=e}t.isTrigger||a.resetHtml(a.data)}),t.find(".r-list a").bind("click",function(){zhx.dialog.selectGroupSingleton(function(e){a.data.searchData=e;var t={microshoppId:zhx.config.store.id,pageIndex:1,pageSize:18};i.extend(t,e),zhx.data.jsonp(zhx.data.host+"/api/finding/v1/listings",t).success(function(i){a.data.goodsList.length=0,Array.prototype.push.apply(a.data.goodsList,i.result.listingList||[]),a.addGoodsListHtml(),a.resetHtml(a.data)})})}),a.addGoodsListHtml(),a.resetHtml(a.data)},addGoodsListHtml:function(){var e=this.data.num,t="waterfall"==this.data.type,a=this.data.goodsList;a&&a.length||(a=this.def.imgList);var l=[],n=[],s=function(i,t){var a=[];return t<e&&(a.p('<li class="li-'+(t+1)+'">'),a.p('<a  class = "goods-img " href = "">'),a.p('<img src = "'+(i.imgUrl_xl||i.imgUrl_s)+'">'),a.p("</a>"),a.p('<div class = "info-box">'),a.p('<p class="goods-name" href = ""><a>'+i.listingName+"</a></p>"),a.p('<p class="goods-price">¥'+i.minPrice+"</p>"),a.p('<a class="btn-buy" href = "">订购</a>'),a.p("</div>"),a.p('<div class = "promotion-box none">'),a.p('<div class = "prom-price">'),a.p("<strong>¥"+i.minPrice+"</strong>"),a.p("<del>原价：¥"+(i.maxPrice||"")+"</del>"),a.p("</div>"),a.p('<a class = "btn-prom" href = "" data-id="'+i.listingId+'">我要抢购</a>'),a.p("</div>"),a.p("</li>")),a};i.each(a,function(i){t&&i%2?Array.prototype.push.apply(n,s(this,i)):Array.prototype.push.apply(l,s(this,i))}),t?(this.viewElem.find(".ul-1").html(l.join(" ")),this.viewElem.find(".ul-2").html(n.join(" ")).show()):(this.viewElem.find(".ul-1").html(l.join(" ")),this.viewElem.find(".ul-2").hide())},resetHtml:function(i){var e=this,t=function(){var t=this.viewElem,a=(this.settingElem,t.find(".mc")),l=t.find("ul"),n=i;zhx.changeClass(t,this.def.listClass,n.pattern),zhx.changeClass(a.find("ul"),this.def.listStyle,n.type),zhx.changeClass(l,e.def.buyClass,n.buyStyle),"waterfall"==e.data.type&&(a.find(".info-box").toggleClass("pos-box",!e.data.showName&&!e.data.showPrice&&e.data.showBuy),a.find(".info-box").toggleClass("h-none",!e.data.showName&&!e.data.showPrice&&e.data.showBuy)),a.find(".goods-name").toggleClass("none",!n.showName),a.find(".goods-price").toggleClass("none",!n.showPrice),zhx.resetHeight()};requestAnimationFrame(function(){t.apply(e)})},resetSetting:function(i){var e=this,t=function(){var e=(this.viewElem,this.settingElem),t=i,a=["big","small","bigAndSmall","detail"],l=a.indexOf(t.pattern);~l||(l=0),zhx.changeClass(e.find(".detail-info"),this.def.detailClass,t.pattern),e.find(".list-style .label-radio").eq(l).trigger("click");var n=["card","waterfall","simple","promotion"],s=n.indexOf(t.type);~s||(s=0),e.find(".show-type .label-radio").eq(s).trigger("click"),zhx.other.activeCheck(e.find(".buy-chk label"),!!t.showBuy),t.buyStyle&&e.find(".buy-btn-style .label-radio").eq(t.buyStyle-1).trigger("click"),zhx.other.activeCheck(e.find(".show-name label"),!!t.showName),zhx.other.activeCheck(e.find(".show-price label"),!!t.showPrice)};requestAnimationFrame(function(){t.apply(e)})},edit:function(e){var t=this;this.resetHtml(e),this.resetSetting(e);var a=i.extend(!0,{},e.initSearchData);delete a.type,zhx.data.getGoods(a).then(function(i){Array.prototype.push.apply(t.data.goodsList,i.listingList||[]),t.addGoodsListHtml(),t.resetHtml(t.data)})}}})}(jQuery),function(i){zhx.addPlugin("goodsSearch",function(){return{name:"商品搜索",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "gs-search">'),i.p('<div class = "mc"><p><label class="label-search"><input type="text" placeholder="搜索商品" disabled="disabled"/><i class="i-icon"></i></label></p></div>'),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-gs-search" style="display: block">'),i.p('<p><span>背景色：</span><label class = "label-color"><input type = "color" value = "#ffffff"></label><input class="btn-reset" type="button" value="重置"/>'),i.p("</p>"),i.p("</div>"),i.join(" ")},data:{bgColor:"#ffffff"},init:function(i,e){var t=this;e.find(".label-color input").bind("change",function(){i.find(".mc").css("background-color",this.value),t.data.bgColor=this.value}),e.find(".btn-reset").bind("click",function(){e.find(".label-color input").val("#ffffff"),e.find(".label-color input").trigger("change")})},edit:function(i){var e=this.settingElem;e.find(".label-color input").val(i.bgColor).trigger("change")}}})}(jQuery),function(i){zhx.addPlugin("hr",function(){return{name:"辅助线",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "sty-hr">'),i.p('<div class = "mc"><p></p></div>'),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-sty-hr" style="display: block">'),i.p('<p><span>颜色：</span><label class = "label-color"><input type = "color" value = "#ececec"></label><input class="btn-reset" type="button" value="重置"/>'),i.p('<label class="label-checkbox"><input type="checkbox"/>左右留边<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p><span>分类：</span><label class = "label-radio label-radio-active"><input type = "radio" value = "solid"  checked="checked"/>实线 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" value = "dashed"/>虚线<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" value = "dotted"/>点线 <i class = "i-icon"></i></label>'),i.p("</p>"),i.p("</div>"),i.join(" ")},data:{isBlank:!1,color:"#ececec",type:"solid"},init:function(e,t){var a=this,l=t.find(".label-radio");zhx.other.checkbox(t.find(".label-checkbox"),function(){var t=i(this).prop("checked");t?e.find(".mc p").addClass("is-blank"):e.find(".mc p").removeClass("is-blank"),a.data.isBlank=t}),zhx.other.radio(l,function(t){var l=i(this).val();e.find(".mc p").css("border-bottom-style",l),a.data.type=l}),t.find(".label-color input").bind("change",function(){e.find(".mc p").css("border-color",this.value),a.data.color=this.value}),t.find(".btn-reset").bind("click",function(){t.find(".label-color input").val("#ececec"),t.find(".label-color input").trigger("change"),l.eq(0).trigger("click"),t.find(".label-checkbox input").eq(0).prop("checked")&&t.find(".label-checkbox").eq(0).trigger("click")})},edit:function(e){var t=i.extend(this.data,e),a=(this.viewElem,this.settingElem);t.isBlank&&a.find(".label-checkbox").trigger("click");var l=["solid","dashed","dotted"];a.find(".label-radio").eq(l.indexOf(t.type)).trigger("click"),a.find(".label-color input").val(t.color).trigger("change")}}})}(jQuery),function(i){zhx.addPlugin("imgAd",function(){return{name:"图片广告",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "img-ad ">'),i.p('<div class = "mc type-carousel">'),i.p('<div class = "adi-list">'),i.p('<a href="">'),i.p('<img src = "'+zhx.config.imgroot+'/img_bg_101.jpg" />'),i.p("</a>"),i.p("</div>"),i.p('<ul class="adi-list-icon">'),i.p("</ul>"),i.p("</div>"),i.p(""),i.p("</div>"),i.join(" ")},viewItem:function(i,e){var t=[];return t.p("<a>"),t.p('<img src = "'+i+'" alt = "">'),e?(t.p('<cite class="c-bg"></cite>'),t.p('<cite class="c-txt">'+e+"</cite>")):(t.p('<cite class="c-bg none"></cite>'),t.p('<cite class="c-txt none"></cite>')),t.p("</a>"),t.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class="set-img-ad" style = "display: block">'),i.p('<p class="show-method"><span>显示方式：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" value = "carousel" name = "method" checked = "checked"/>折叠轮播 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "method" value = "separate"/>分开显示<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p class="show-size type-car"><span>显示大小：</span>'),i.p('<label class = "label-radio label-radio-active"><input type = "radio" value = "big" name = "showSize" checked = "checked"/>大图 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio min-rdi"><input type = "radio" name = "showSize" value = "small"/>小图<i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<ul class="img-ad-list clearfix">'),i.p('<li class="move-li"></li>'),i.p("</ul>"),i.p('<p class="nav-link"><label><i></i>添加一个广告<input type="file"/></label></p>'),i.p("</div>"),i.join(" ")},liTemplate:function(i){var e=[];return e.p("<li>"),e.p('<div class="ad-img-bg">'),e.p('<img src="'+i+'"/>'),e.p('<cite class="c-bg"></cite>'),e.p('<cite class="c-txt"><label >重新上传<input type="file"/></label></cite>'),e.p("</div>"),e.p('<div class="ad-img-info">'),e.p('<p><span>标题：</span><label class = "label-input link-txt"><input type = "text" maxlength = "20"></label></p>'),e.p('<p><span>链接：</span><label class="link-sname"><em></em><i>X</i></label><label class = "label-select link-address"><strong>设置链接到的页面地址</strong>'),e.p("<a>"),e.p('<label style="display: none" data-val="-2"></label>'),e.p('<label data-val="1">微页面</label>'),e.p('<label data-val="2">商品</label>'),e.p('<label data-val="5">店铺主页</label>'),e.p('<label data-val="7">自定义外链</label>'),e.p('</a><i class="i-icon"></i>'),e.p("</label>"),e.p("</p>"),e.p('<div class="other-link-box"><p><label class="label-input label-oth-link"><input maxlength="100" placeholder="链接地址: http://example.com"/></label><a class="btn-oth-ok">确认</a><a class="btn-oth-cel">取消</a></p><i class="i-top"></i></div>'),e.p("</div>"),e.p('<i class="i-close">x</i>'),e.p("</li>"),e.join(" ")},data:{method:"carousel",showSize:"big",imgList:[]},checkImg:function(e,t){var a=[];i.each(e,function(i,l){var n=e.eq(i).find("img")[0];if(n.src)var s=function(){(n.width>0||n.height>0)&&(a.push(n.height),clearInterval(o),a.length==e.length&&t&&t(a))},o=setInterval(s,40)})},setMaxHeight:function(i,e){if("carousel"==i.data.method){if(i.data.imgList.length<2)return e.height("auto"),void e.find("a").height("auto");i.checkImg(e.find(".adi-list"),function(i){var t=Math.max.apply([],i);e.height(t),e.find("a").height(t)})}else e.height("auto"),e.find("a").height("auto")},init:function(e,t){var a=this,l=t.find(".label-radio"),n={carousel:"type-carousel",separate:"type-separate"};zhx.other.radio(l,function(i,l){switch(i){case"method":a.data.method=l,t.find(".show-size").toggleClass("type-car","separate"!=l),"carousel"==a.data.method&&"small"==a.data.showSize&&t.find(".show-size .label-radio").eq(0).trigger("click"),zhx.changeClass(e.find(".mc"),n,l),a.setMaxHeight(a,e.find(".mc"));break;case"showSize":a.data.showSize=l,e.find(".adi-list").toggleClass("sm-list","small"==l)}});var s=t.find(".img-ad-list"),o=e.find(".adi-list"),d=e.find(".adi-list-icon"),c=s.find("li").not(".move-li"),r=function(){c=s.find("li").not(".move-li")};t.find(".img-ad-list").bind("editEvent",function(){var t=a.data.imgList;i.each(t,function(i,e){s.append(a.liTemplate(e.src))}),r(),h(),p(),a.setMaxHeight(a,e.find(".mc"))});var p=function(){var t=[];i.each(a.data.imgList,function(){t.push(a.viewItem(this.src,this.title))}),o.html(t.join(" "));var l=[];a.data.imgList.length>1?(i.each(a.data.imgList,function(i){0==i?l.push('<li class="active">.</li>'):l.push("<li>.</li>")}),d.html(l.join(" "))):d.html(""),0==a.data.imgList.length&&(o.html('<a><img src = "'+zhx.config.imgroot+'/img_bg_101.jpg" alt = ""></a>'),e.find(".mc").removeAttr("style"))},h=function(){s.find(".i-close").unbind("click").bind("click",function(){var t=i(this).parent("li"),l=c.index(t);l>=0&&a.data.imgList.splice(l,1),t.remove(),r(),p(),a.setMaxHeight(a,e.find(".mc"))}),s.find(".link-txt input").unbind("blur").bind("blur",function(){var e=i(this).val(),t=i(this).parents("li"),l=c.index(t);a.data.imgList[l].title=e,i.trim(e)?(o.find("a").eq(l).find(".c-txt").html(e),o.find("a").eq(l).find("cite").removeClass("none")):o.find("a").eq(l).find("cite").addClass("none")}),s.find(".c-txt input").unbind("change").bind("change",function(){var t=i(this).parents("li"),l=c.index(t),n=this.files[0];zhx.data.uploadImg(n).success(function(i){if(0==i.status){var n=i.url;t.find("img").attr("src",n),a.data.imgList[l].src=n,p(),a.setMaxHeight(a,e.find(".mc"))}else zhx.box.msg(i.message)}).error(function(){zhx.box.msg("上传失败！")})}),s.find("li").unbind("mousedown").bind("mousedown",function(t){var l=i(this);"LI"==t.target.nodeName&&l.shareDrag(s.find(".move-li"),s.find("li").not(".move-li"),function(){r(),c.each(function(t){var l=i(this);l.find("input").trigger("blur"),l.find(".link-address").trigger("click");var n=l.find("img");a.data.imgList[t].src=n.attr("src"),a.data.imgList[t].size={w:n[0].naturalWidth,h:n[0].naturalHeight},p(),a.setMaxHeight(a,e.find(".mc"))})},t)}),s.find(".btn-oth-cel").unbind("click").bind("click",function(){var i=s.find(".btn-oth-cel").index(this);s.find(".other-link-box").eq(i).hide()}),s.find(".btn-oth-ok").unbind("click").bind("click",function(){var i=c.find(".btn-oth-ok").index(this),e=a.data.imgList[i].link=c.find(".other-link-box input").eq(i).val();c.find(".link-sname").eq(i).find("em").text("外链|"+e),c.find(".other-link-box").eq(i).hide()});var t=c.find(".link-address"),l=c.find(".link-sname");zhx.other.select(t,function(e,t){var n=i(this),s=i(this).parents("li"),o=c.index(s);l=c.find(".link-sname"),n.attr("data-val",e.value);var d=function(i){n.find("strong").text(i?"修改":"设置链接到的页面地址")},r=function(i){l.eq(o).addClass("link-mar15").find("em").text(i)},p=function(i){i&&(r(i.typeName+"|"+i.name),a.data.imgList[o].link=i.src,d(1))};switch(e.value){case"-2":l.eq(o).removeClass("link-mar15").find("em").text(e.text),d(0);break;case"1":if(t.isTrigger){var h={typeName:e.text,name:a.data.imgList[o].name,src:a.data.imgList[o].link};p(h)}else zhx.dialog.selectMinPage(p);break;case"2":if(t.isTrigger){var h={typeName:e.text,name:a.data.imgList[o].name,src:a.data.imgList[o].link};p(h)}else zhx.dialog.selectGoodsSingleton(p);break;case"3":zhx.dialog.selectActivity(p);break;case"5":l.eq(o).addClass("link-mar15").find("em").text(e.text),a.data.imgList[o].link=zhx.config.store.mainPageUrl,d(1);break;case"7":a.data.imgList[o].link=c.eq(o).find(".other-link-box input").val(),l.eq(o).addClass("link-mar15").find("em").text("外链|"+a.data.imgList[o].link),t.isTrigger||c.find(".other-link-box").eq(o).show(),d(1)}a.data.imgList[o].type=e.value}),l.find("em").unbind("click").bind("click",function(){l=c.find(".link-sname");var i=l.find("em").index(this);7==a.data.imgList[i].type&&c.find(".other-link-box").eq(i).show()}),l.find("i").unbind("click").bind("click",function(){l=c.find(".link-sname");var i=l.find("i").index(this);c.eq(i).find(".other-link-box input").val(""),c.find(".link-address").eq(i).find("label").eq(0).trigger("click")})};t.find(".nav-link input").bind("change",function(){var i=this.files[0];zhx.data.uploadImg(i).success(function(i){if(0==i.status){var t=i.url;a.data.imgList.push({src:t,link:"",type:"",title:"",name:"",size:{w:0,h:0}}),s.append(a.liTemplate(t)),r(),h(),p(),a.setMaxHeight(a,e.find(".mc"))}else zhx.box.msg(i.message)}).error(function(){zhx.box.msg("上传失败！")})})},edit:function(e){var t=i.extend({},this.data,e),a=[-2,1,2,5,7],l=(this.viewElem,this.settingElem),n=l.find(".img-ad-list");if(n.trigger("editEvent"),"separate"==t.method&&l.find(".show-method").find(".label-radio").eq(1).trigger("click"),"small"==t.showSize&&l.find(".show-size").find(".label-radio").eq(1).trigger("click"),t.imgList){var s=n.find("li").not(".move-li");i.each(t.imgList,function(i,e){s.eq(i).find(".link-txt input").val(e.title).trigger("blur"),7==e.type&&(s.eq(i).find(".other-link-box input").val(e.link),s.eq(i).find(".btn-oth-ok").trigger("click")),s.eq(i).find(".link-address").find("label").eq(a.indexOf(parseInt(e.type))).trigger("click")})}}}})}(jQuery),function(i){zhx.addPlugin("imgNav",function(){return{name:"图片导航",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "img-nav">'),i.p('<div class = "mc">'),i.p("<a><img /><p></p></a>"),i.p("<a><img /><p></p></a>"),i.p("<a><img /><p></p></a>"),i.p("<a><img /><p></p></a>"),i.p("</div>"),i.p("</div>"),i.join(" ")},viewItem:function(i,e){var t=[];return t.p('<a><img src="'+(i||"")+'"/>'),t.p("<p>"+(e||"")+"</p>"),t.p("</a>"),t.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-img-nav">'),i.p('<ul class="sin-img-list">'),i.p("</ul>"),i.p("</div>"),i.join(" ")},liTemplate:function(i){var e=[];return e.p('<li class="clearfix">'),e.p('<div class="nav-img-bg">'),e.p("<img/>"),e.p('<label class="add-img"><i></i>添加图片<input type="file"/></label>'),e.p('<cite class="c-bg"></cite>'),e.p('<cite class="c-txt">重新上传<input type="file"/></cite>'),e.p('<p><em class="msg msg-img">图片不能为空！</em></p>'),e.p("</div>"),e.p('<div class="nav-img-info">'),e.p('<p><span>文字：</span><label class = "label-input link-txt"><input type = "text" maxlength = "20"></label></p>'),e.p('<p><span>链接：</span><label class="link-sname"><em></em><i>X</i></label><label class = "label-select link-address"><strong>设置链接到的页面地址</strong>'),e.p("<a>"),e.p('<label style="display: none" data-val="-2"></label>'),e.p('<label data-val="1">微页面</label>'),e.p('<label data-val="2">商品</label>'),e.p('<label data-val="5">店铺主页</label>'),e.p('<label data-val="7">自定义外链</label>'),e.p('</a><i class="i-icon"></i>'),e.p("</label>"),e.p("</p>"),e.p('<p><em class="msg msg-link">链接不能为空！</em></p>'),e.p("</div>"),e.p('<div class="other-link-box"><p><label class="label-input label-oth-link"><input maxlength="100" placeholder="链接地址: http://example.com"/></label><a class="btn-oth-ok">确认</a><a class="btn-oth-cel">取消</a></p><i class="i-top"></i></div>'),e.p("</li>"),e.join(" ")},data:{list:[]},init:function(e,t){function a(){var i=[];i.push('<li class="move-li clearfix"></li>');for(var e=0;e<4;e++)i.push(l.liTemplate()),l.data.list.length>=4||l.data.list.push({src:"",size:{w:0,h:0},name:"",title:"",link:"",type:""});n.html(i.join(" "))}var l=this,n=t.find(".sin-img-list"),s=e.find(".mc"),o=n.find("li").not(".move-li"),d=function(){o=n.find("li").not(".move-li")},c=function(){l.resetViewImg()},r=function(){n.find(".i-close").unbind("click").bind("click",function(){var e=i(this).parent("li"),a=o.index(e);a>=0&&l.data.list.splice(a,1),e.remove(),l.data.list.length<20&&t.find(".nav-link").show(),d(),c()}),n.find(".link-txt input").unbind("blur").bind("blur",function(){var e=i(this).val()||" ",t=i(this).parents("li"),a=o.index(t);l.data.list[a].title=e,s.find("a").eq(a).find("p").html(e)}),n.find(".c-txt input").unbind("change").bind("change",function(){var e=i(this).parents("li");p(e,0,this.files[0])}),t.find(".add-img input").unbind("change").bind("change",function(){var e=i(this).parents("li");p(e,1,this.files[0])}),n.find("li").unbind("mousedown").bind("mousedown",function(e){var t=i(this);"LI"!=e.target.nodeName&&"P"!=e.target.nodeName||t.shareDrag(n.find(".move-li"),n.find("li").not(".move-li"),function(){d(),o.each(function(e){var t=i(this);t.find("input").trigger("blur"),t.find(".link-address .select").length?t.find(".link-address .select").trigger("click"):t.find(".link-address label").eq(0).trigger("click");var a=t.find("img");l.data.list[e].src=a.attr("src"),l.data.list[e].size={w:a[0].naturalWidth,h:a[0].naturalHeight},c()})},e)}),n.find(".btn-oth-cel").unbind("click").bind("click",function(){var i=n.find(".btn-oth-cel").index(this);n.find(".other-link-box").eq(i).hide()}),n.find(".btn-oth-ok").unbind("click").bind("click",function(){var i=o.find(".btn-oth-ok").index(this),e=l.data.list[i].link=o.find(".other-link-box input").eq(i).val();o.find(".link-sname").eq(i).find("em").text("外链|"+e),o.find(".other-link-box").eq(i).hide()});var e=o.find(".link-address"),a=o.find(".link-sname");zhx.other.select(e,function(e,t){var n=i(this),s=i(this).parents("li"),d=o.index(s);a=o.find(".link-sname"),n.attr("data-val",e.value);var c=function(i){n.find("strong").text(i?"修改":"设置链接到的页面地址")},r=function(i){a.eq(d).addClass("link-mar15").find("em").text(i)},p=function(i){i&&(r(i.typeName+"|"+i.name),l.data.list[d].link=i.src,c(1))};switch(e.value){case"-2":a.eq(d).removeClass("link-mar15").find("em").text(e.text),c(0);break;case"1":if(t.isTrigger){var h={typeName:e.text,name:l.data.list[d].name,src:l.data.list[d].link};p(h)}else zhx.dialog.selectMinPage(p);break;case"2":if(t.isTrigger){var h={typeName:e.text,name:l.data.list[d].name,src:l.data.list[d].link};p(h)}else zhx.dialog.selectGoodsSingleton(p);break;case"3":zhx.dialog.selectActivity(p);break;case"5":a.eq(d).addClass("link-mar15").find("em").text(e.text),c(1),l.data.list[d].link=zhx.config.store.mainPageUrl;break;case"7":var u=l.data.list[d].link=o.eq(d).find(".other-link-box input").val();r("外链|"+u),t.isTrigger||o.find(".other-link-box").eq(d).show(),c(1)}l.data.list[d].type=e.value,e.value>0?s.find(".msg-link").hide():s.find(".msg-link").show()}),a.find("em").unbind("click").bind("click",function(){a=o.find(".link-sname");var i=a.find("em").index(this);7==l.data.list[i].type&&o.find(".other-link-box").eq(i).show()}),a.find("i").unbind("click").bind("click",function(){a=o.find(".link-sname");var i=a.find("i").index(this);o.eq(i).find(".other-link-box input").val(""),o.find(".link-address").eq(i).find("label").eq(0).trigger("click")})};a(),d(),r();var p=function(i,e,a){var n=o.index(i);zhx.data.uploadImg(a).success(function(a){if(0==a.status){var s=a.url;e&&(i.find(".add-img").addClass("none"),i.find("cite").show(),t.find(".msg-img").eq(n).hide()),i.find("img").attr("src",s),l.data.list[n].src=s,l.data.list[n].size={w:0,h:0},c()}else zhx.box.msg(a.message)}).error(function(){zhx.box.msg("上传失败！")})}},resetViewImg:function(){var e=[],t=this;i.each(t.data.list,function(){e.push(t.viewItem(this.src,this.title))}),this.viewElem.find(".mc").html(e.join(" "))},check:function(){var e=(this.viewElem,this.settingElem),t=!0,a=this.data,l=e.find("li").not(".move-li"),n=l.find(".msg-link"),s=l.find(".msg-img");return i.each(a.list,function(i,e){e.type>0?n.eq(i).hide():(t=!1,n.eq(i).show()),e.src?s.eq(i).hide():(t=!1,s.eq(i).show())}),t},edit:function(e){var t=e,a=[-2,1,2,5,7],l=(this.viewElem,this.settingElem),n=l.find(".sin-img-list"),s=n.find("li").not(".move-li");i.each(t.list,function(i,e){var t=s.eq(i);e.type&&(t.find(".add-img").addClass("none"),t.find("cite").show(),t.find("img").attr("src",e.src),t.find(".link-txt input").val(e.title).trigger("blur"),7==e.type&&(t.find(".other-link-box input").val(e.link),t.find(".btn-oth-ok").trigger("click")),t.find(".link-address").find("label").eq(a.indexOf(parseInt(e.type))).trigger("click"))}),this.resetViewImg()}}})}(jQuery),function(i){zhx.addPlugin("notice",function(){return{name:"公告",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "sty-notice">'),i.p('<div class = "mc"><p>公告：<span>请填写内容，如果过长，将会在手机上滚动显示</span></p></div>'),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-notice" style="display: block">'),i.p('<p><span>公告：</span><label class = "label-input"><input type = "text" maxlength="200" placeholder="请填写内容，如果过长，将会在手机上滚动显示"/></label>'),i.p("</p>"),i.p('<p class="msg msg-title"><em >内容不能为空！</em></p>'),i.p("</div>"),i.join(" ")},data:{text:""},init:function(e,t){var a=this;t.find(".label-input input").bind("blur",function(){var l=i(this),n=l.val();e.find("p span").text(n||"请填写内容，如果过长，将会在手机上滚动显示"),a.data.text=n,i.trim(n)&&t.find(".msg-title").hide()})},check:function(){var e=(this.viewElem,this.settingElem),t=!0,a=this.data,l=e.find(".msg-title");return i.trim(a.text)?l.hide():(t=!1,l.show()),t},edit:function(i){var e=this.settingElem;e.find(".label-input input").val(i.text).trigger("blur")}}})}(jQuery),function(i){zhx.addPlugin("pageTitle",function(){return{name:"页面头部标题",isDelete:0,isRepeat:0,isShowOp:0,noView:1,viewTemplate:function(){return".p-title"},settingTemplate:function(){var i=[];return i.p('<div class = "set-title">'),i.p('<p><span><em>*</em>页面名称：</span><label class = "label-input page-name"><input type = "text" maxlength = "20"></label></p>'),i.p('<p><span>页面描述：</span><label class = "label-input page-des"><input type = "text" maxlength = "20" placeholder="用户通过微信分享给朋友时，会自动显示页面描述"></label></p>'),i.p('<p><span>背景颜色：</span><label class = "label-color"><input type = "color" value = "#ffffff"></label><input class = "btn-reset" type = "button" value = "重置"/></p>'),i.p("</div>"),i.join(" ")},data:{title:"",des:"",bodyBg:"#ffffff"},init:function(e,t){var a=this,l=a.data.title;l&&(e.find("h3").text(l),t.find(".page-name input").val(l)),t.find(".page-name input").bind("blur",function(){var t=i(this),l=t.val();e.find("h3").text(l),a.data.title=l}),t.find(".page-des input").bind("blur",function(){var e=i(this),t=e.val();a.data.des=t}),t.find(".label-color input").bind("change",function(){zhx.config.root.css("background-color",this.value),a.data.bodyBg=this.value}),t.find(".btn-reset").bind("click",function(){t.find(".label-color input").val("#ffffff"),t.find(".label-color input").trigger("change")})},edit:function(e){var t=i.extend({},this.data,e),a=(this.viewElem,this.settingElem);a.find(".page-name input").val(t.title).trigger("blur"),a.find(".page-des input").val(t.des).trigger("blur"),a.find(".label-color input").val(t.bodyBg).trigger("change")}}})}(jQuery),function(i){zhx.addPlugin("textNav",function(){return{name:"文本导航",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "text-nav">'),i.p('<div class = "mc">'),i.p('<h3><span>点击编辑导航</span><i class = "i-right"></i></h3>'),i.p("</div>"),i.p("</div>"),i.join(" ")},viewItem:function(i){return"<h3><span>"+(i||"点击编辑导航")+'</span><i class = "i-right"></i></h3>'},liTemplate:function(i){var e=[];return e.p("<li>"),e.p('<p><span>导航名称：</span><label class = "label-input link-txt"><input type = "text" maxlength = "20"></label></p>'),e.p('<p><span>链接到：</span><label class="link-sname"><em></em><i>X</i></label><label class = "label-select link-address"><strong>设置链接到的页面地址</strong>'),e.p("<a>"),e.p('<label style="display: none" data-val="-2"></label>'),e.p('<label data-val="1">微页面</label>'),e.p('<label data-val="2">商品</label>'),e.p('<label data-val="5">店铺主页</label>'),e.p('<label data-val="7">自定义外链</label>'),e.p('</a><i class="i-icon"></i>'),e.p("</label>"),e.p("</p>"),e.p('<div class="other-link-box"><p><label class="label-input label-oth-link"><input maxlength="100" placeholder="链接地址: http://example.com"/></label><a class="btn-oth-ok">确认</a><a class="btn-oth-cel">取消</a></p><i class="i-top"></i></div>'),e.p('<i class="i-close">x</i>'),e.p("</li>"),e.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-text-nav">'),i.p('<ul class="stn-nav-list move-ul">'),i.p('<li class="move-li"></li>'),i.p("</ul>"),i.p('<p class="nav-link"><a><i></i>添加一个文本导航</a></p>'),i.p("</div>"),i.join(" ")},data:{linkList:[]},init:function(e,t){var a=this,l=t.find(".stn-nav-list"),n=e.find(".mc"),s=l.find("li").not(".move-li"),o=function(){s=l.find("li").not(".move-li")},d=function(){var e=[];i.each(a.data.linkList,function(){e.push(a.viewItem(this.title))}),n.html(e.join(" ")),n.find("h3").last().toggleClass("no-bor",!(a.data.linkList.length<=1)),0==a.data.linkList.length&&n.html(a.viewItem())},c=function(){l.find(".i-close").unbind("click").bind("click",function(){var e=i(this).parent("li"),l=s.index(e);l>=0&&a.data.linkList.splice(l,1),e.remove(),a.data.linkList.length<20&&t.find(".nav-link").show(),o(),d()}),l.find(".link-txt input").unbind("blur").bind("blur",function(){var e=i(this).val()||" ",t=i(this).parents("li"),l=s.index(t);a.data.linkList[l].title=e,n.find("h3").eq(l).find("span").html(e)}),l.find("li").unbind("mousedown").bind("mousedown",function(e){var t=i(this);"P"==e.target.nodeName&&t.shareDrag(l.find(".move-li"),l.find("li").not(".move-li"),function(){o(),s.each(function(){i(this).find("input").trigger("blur"),i(this).find(".link-address .select").length&&i(this).find(".link-address .select").trigger("click")})},e)}),l.find(".btn-oth-cel").unbind("click").bind("click",function(){var i=l.find(".btn-oth-cel").index(this);l.find(".other-link-box").eq(i).hide()}),l.find(".btn-oth-ok").unbind("click").bind("click",function(){var i=s.find(".btn-oth-ok").index(this),e=a.data.linkList[i].src=s.find(".other-link-box input").eq(i).val();s.find(".link-sname").eq(i).find("em").text("外链|"+e),s.find(".other-link-box").eq(i).hide()});var e=s.find(".link-address"),c=s.find(".link-sname");zhx.other.select(e,function(e,t){var l=i(this),n=i(this).parents("li"),o=s.index(n);c=s.find(".link-sname"),l.attr("data-val",e.value);var d=function(i){l.find("strong").text(i?"修改":"设置链接到的页面地址")},r=function(i){c.eq(o).addClass("link-mar15").find("em").text(i)},p=function(i){i&&(r(i.typeName+"|"+i.name),a.data.linkList[o].name=i.name,a.data.linkList[o].src=i.src,d(1))};switch(e.value){case"-2":c.eq(o).removeClass("link-mar15").find("em").text(e.text),d(0);break;case"1":if(t.isTrigger){var h={typeName:e.text,name:a.data.linkList[o].name,src:a.data.linkList[o].src};p(h)}else zhx.dialog.selectMinPage(p);break;case"2":if(t.isTrigger){var h={typeName:e.text,name:a.data.linkList[o].name,src:a.data.linkList[o].src};p(h)}else zhx.dialog.selectGoodsSingleton(p);break;case"3":zhx.dialog.selectActivity(p);break;case"5":c.eq(o).addClass("link-mar15").find("em").text(e.text),a.data.linkList[o].src=zhx.config.store.mainPageUrl,d(1);break;case"7":a.data.linkList[o].src=s.eq(o).find(".other-link-box input").val(),c.eq(o).addClass("link-mar15").find("em").text("外链|"+a.data.linkList[o].src),t.isTrigger||s.find(".other-link-box").eq(o).show(),d(1)}a.data.linkList[o].type=e.value}),c.find("em").unbind("click").bind("click",function(){c=s.find(".link-sname");var i=c.find("em").index(this);7==a.data.linkList[i].type&&s.find(".other-link-box").eq(i).show()}),c.find("i").unbind("click").bind("click",function(){c=s.find(".link-sname");var i=c.find("i").index(this);s.eq(i).find(".other-link-box input").val(""),s.find(".link-address").eq(i).find("label").eq(0).trigger("click")})};t.find(".nav-link").bind("click",function(i){var e=a.liTemplate();l.append(e),i.isTrigger?a.data.linkList.push({uuid:a.data.oldList[a.data.linkList.length].uuid,title:" ",name:"",src:"",type:-1}):a.data.linkList.push({uuid:"",title:" ",name:"",src:"",type:-1}),a.data.linkList.length>=20&&t.find(".nav-link").hide(),s=l.find("li").not(".move-li"),c(),d()})},edit:function(e){var t=e,a=(this.viewElem,this.settingElem),l=a.find(".stn-nav-list"),n=[-2,1,2,5,7];this.data.linkList=[],this.data.oldList=e.linkList,i.each(t.linkList,function(i,e){a.find(".nav-link").trigger("click"),l.find(".link-txt input").eq(i).val(e.title).trigger("blur"),l.find(".link-address").eq(i).find("label").eq(n.indexOf(parseInt(e.type))).trigger("click"),7==e.type&&(a.find(".other-link-box input").eq(i).val(e.src),a.find(".btn-oth-ok").eq(i).trigger("click"))})}}})}(jQuery),function(i){zhx.addPlugin("textTitle",function(){return{name:"标题",isDelete:1,isRepeat:1,isShowOp:1,viewTemplate:function(){var i=[];return i.p('<div class = "text-title">'),i.p('<div class = "mc">'),i.p('<div class = "panel-1">'),i.p("<h3><span>点击编辑标题</span><label>-<a></a></label></h3>"),
i.p('<p class="tt-subtitle"><label></label></p>'),i.p("</div>"),i.p('<div class = "panel-2">'),i.p("<h3><span>点击编辑标题</span></h3>"),i.p('<p class="tt-subtitle clearfix"><label class="tt-date"></label> <label class="tt-author"></label> <a></a></p>'),i.p("</div>"),i.p("</div>"),i.p("</div>"),i.join(" ")},settingTemplate:function(){var i=[];return i.p('<div class = "set-text-title" style = "display: block">'),i.p('<p><span><em>*</em>标题名：</span><label class = "label-input stt-title"><input type = "text" defaultValue="点击编辑标题" maxlength = "20"></label></p>'),i.p('<p><em class="msg msg-title">标题不能为空！</em></p>'),i.p("<p><span>标题模版：</span>"),i.p('<label class = "label-radio label-radio-active"><input type = "radio" value = "tradition" name = "titleType" checked = "checked"/>传统样式<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "titleType" value = "wx"/>模仿微信图文页样式 <i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<div class="panel-1">'),i.p('<p><span>副标题：</span><label class = "label-input stt-subtitle"><input type = "text" maxlength = "20"></label></p>'),i.p("<p><span>显示：</span>"),i.p('<label class = "label-radio label-radio-active"><input type = "radio" value = "left" name = "textAlign" checked = "checked"/>居左 <i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "textAlign" value = "center"/>居中<i class = "i-icon"></i></label>'),i.p('<label class = "label-radio"><input type = "radio" name = "textAlign" value = "right"/>居右 <i class = "i-icon"></i></label>'),i.p("</p>"),i.p('<p><span>背景颜色：</span><label class = "label-color"><input type = "color" value = "#ffffff"></label><input class = "btn-reset" type = "button" value = "重置"/></p>'),i.p('<p class="nav-link"><a><i></i>添加一个文本导航</a></p>'),i.p('<div class="link-text-box">'),i.p('<p><span><em>*</em>名称：</span><label class = "label-input link-txt"><input type = "text" maxlength = "20"></label></p>'),i.p('<p><span><em>*</em>链接：</span><label class="link-sname"><em></em><i>X</i></label><label class = "label-select link-address subtitle-link"><strong>设置链接到的页面地址</strong>'),i.p("<a>"),i.p('<label style="display: none" data-val="-2"></label>'),i.p('<label data-val="1">微页面</label>'),i.p('<label data-val="2">商品</label>'),i.p('<label data-val="5">店铺主页</label>'),i.p('<label data-val="7">自定义外链</label>'),i.p('</a><i class="i-icon"></i>'),i.p("</label></p>"),i.p('<i class="i-close">x</i>'),i.p('<div class="other-link-box"><p><label class="label-input label-oth-link"><input maxlength="100" placeholder="链接地址: http://example.com"/></label><a class="btn-oth-ok">确认</a><a class="btn-oth-cel">取消</a></p><i class="i-top"></i></div>'),i.p("</div>"),i.p("</div>"),i.p('<div class="panel-2">'),i.p('<p><span>日期：</span><label class = "label-input stt-date"><input type = "text" maxlength = "20" onfocus = "WdatePicker()"></label></p>'),i.p('<p><span>作者：</span><label class = "label-input stt-author"><input type = "text" maxlength = "20"></label></p>'),i.p('<p><span>链接标题：</span><label class = "label-input stt-link-text"><input type = "text" maxlength = "20"></label></p>'),i.p("<p><span>链接地址：</span> "),i.p('<label class = "other-link-radio label-radio label-radio-active"><input type = "radio" value = "other"  checked = "checked" name = "linkType"/>其它链接<i class = "i-icon"></i></label>'),i.p('<label class="link-sname"><em></em><i>X</i></label><label class = "label-select link-address"><strong>设置链接到的页面地址</strong>'),i.p("<a>"),i.p('<label style="display: none" data-val="-2"></label>'),i.p('<label data-val="1">微页面</label>'),i.p('<label data-val="2">商品</label>'),i.p('<label data-val="5">店铺主页</label>'),i.p('<label data-val="7">自定义外链</label>'),i.p('</a><i class="i-icon"></i>'),i.p("</label>"),i.p("</p>"),i.p('<div class="other-link-box"><p><label class="label-input label-oth-link"><input maxlength="100" placeholder="链接地址: http://example.com"/></label><a class="btn-oth-ok">确认</a><a class="btn-oth-cel">取消</a></p><i class="i-top"></i></div>'),i.p("</div>"),i.p("</div>"),i.join(" ")},data:{title:"",titleType:"tradition",tradition:{hasLink:0,link:{text:"",name:"",type:"",src:""},titleBg:"#ffffff",txtAlign:"left",subtitle:""},wx:{datetime:"",author:"",linkTitle:"",linkType:"other",link:{type:"",name:"",src:""}}},init:function(e,t){var a=this,l=a.data.tradition,n=a.data.wx,s=t.find(".label-radio");t.find(".stt-title input").bind("blur",function(){var l=i(this),n=l.val(),s=l.attr("defaultValue");e.find("h3 span").text(n||s),a.data.title=n,i.trim(n)&&t.find(".msg-title").hide()}),t.find(".stt-subtitle input").bind("blur",function(){var t=i(this),a=t.val();e.find(".panel-1 .tt-subtitle label").text(a),l.subtitle=a});var o=e.find("h3 label"),d=t.find(".link-text-box");t.find(".nav-link").bind("click",function(){var e=i(this);e.hide(),o.show(),d.show(),l.hasLink=1}),t.find(".label-color input").bind("change",function(){e.find(".mc").css("background-color",this.value),l.titleBg=this.value}),t.find(".btn-reset").bind("click",function(){t.find(".label-color input").val("#ffffff"),t.find(".label-color input").trigger("change")}),t.find(".i-close").bind("click",function(){t.find(".nav-link").show(),o.hide(),d.hide(),l.hasLink=0}),t.find(".link-txt input").bind("blur",function(){var t=i(this),a=t.val();e.find("h3 label a").text(a),l.link.text=a}),t.find(".btn-oth-cel").unbind("click").bind("click",function(){var i=t.find(".btn-oth-cel").index(this);t.find(".other-link-box").eq(i).hide()}),t.find(".btn-oth-ok").unbind("click").bind("click",function(){var i=t.find(".btn-oth-ok").index(this),e=t.find(".other-link-box input").eq(i).val();0==i?l.link.src=e:n.link.src=e,t.find(".link-sname").eq(i).find("em").text("外链|"+e),t.find(".other-link-box").eq(i).hide()});var c=t.find(".link-address"),r=t.find(".link-sname");zhx.other.select(c,function(e,a){var s=i(this);s.attr("data-val",e.value);var o=c.index(s),d="",p=function(i){s.find("strong").text(i?"修改":"设置链接到的页面地址")},h=function(i){r.eq(o).addClass("link-mar15").find("em").text(i)},u=function(i){i&&(h(i.typeName+"|"+i.name),s.hasClass("subtitle-link")?(l.link.type=e.value,l.link.name=i.name,l.link.src=i.src):(n.link.type=e.value,n.link.name=i.name,n.link.src=i.src),p(1))};switch(e.value){case"-2":r.eq(o).removeClass("link-mar15").find("em").text(e.text),p(0);break;case"1":if(a.isTrigger){var f={typeName:e.text,name:n.link.name,src:n.link.src};s.hasClass("subtitle-link")&&l.link&&(f.name=l.link.name,f.src=l.link.src),u(f)}else zhx.dialog.selectMinPage(u);break;case"2":if(a.isTrigger){var f={typeName:e.text,name:n.link.name,src:n.link.src};s.hasClass("subtitle-link")&&l.link&&(f.name=l.link.name,f.src=l.link.src),u(f)}else zhx.dialog.selectGoodsSingleton(u);break;case"3":zhx.dialog.selectActivity(u);break;case"5":r.eq(o).addClass("link-mar15").find("em").text(e.text),s.hasClass("subtitle-link")?(l.link.type=e.value,l.link.src=zhx.config.store.mainPageUrl):(n.link.type=e.value,n.link.src=zhx.config.store.mainPageUrl),p(1);break;case"7":d=t.find(".other-link-box input").eq(o).val(),r.eq(o).addClass("link-mar15").find("em").text("外链|"+d),s.hasClass("subtitle-link")?(l.link.type=e.value,l.link.src=d):(n.link.type=e.value,n.link.src=d),a.isTrigger||t.find(".other-link-box").eq(o).show(),p(1)}}),r.find("em").unbind("click").bind("click",function(){r=t.find(".link-sname");var i,e=r.find("em").index(this);i=e?n.link.type:l.link.type,7==i&&t.find(".other-link-box").eq(e).show()}),r.find("i").unbind("click").bind("click",function(){r=t.find(".link-sname");var i=r.find("i").index(this);t.find(".other-link-box input").eq(i).val(""),t.find(".link-address").eq(i).find("label").eq(0).trigger("click")}),t.find(".stt-date input").bind("blur",function(){var t=i(this),a=t.val();e.find(".tt-date").text(a),n.datetime=a}),t.find(".stt-author input").bind("blur",function(){var t=i(this),a=t.val();e.find(".tt-author").text(a),n.author=a}),t.find(".stt-link-text input").bind("blur",function(){var t=i(this),a=t.val();e.find(".tt-subtitle a").text(a),n.linkTitle=a});var p=function(i){e.find(".panel-"+i).show(),t.find(".panel-"+i).show()},h=function(i){e.find(".panel-"+i).hide(),t.find(".panel-"+i).hide()};zhx.other.radio(s,function(i,s){switch(i){case"titleType":a.data.titleType=s,"tradition"==s?(p(1),h(2),t.find(".label-color input").trigger("change")):(h(1),p(2),e.find(".mc").removeAttr("style"));break;case"textAlign":var o={left:"txt-left",center:"txt-center",right:"txt-right"};zhx.changeClass(e.find(".panel-1"),o,s),l.txtAlign=s;break;case"linkType":n.linkType=s}})},check:function(){var e=(this.viewElem,this.settingElem),t=!0,a=this.data,l=e.find(".msg-title");return i.trim(a.title)?l.hide():(t=!1,l.show()),t},edit:function(e){var t=i.extend({},this.data,e),a=(this.viewElem,this.settingElem),l=[-2,1,2,5,7];if(a.find(".stt-title input").val(t.title).trigger("blur"),"tradition"==t.titleType){a.find(".stt-subtitle input").val(t.tradition.subtitle).trigger("blur");var n=["left","center","right"];a.find(".panel-1 .label-radio").eq(n.indexOf(t.tradition.txtAlign)).trigger("click"),a.find(".label-color input").val(t.tradition.titleBg).trigger("change"),t.tradition.hasLink&&(a.find(".nav-link").trigger("click"),a.find(".link-txt input").val(t.tradition.link.text).trigger("blur"),a.find(".panel-1 .link-address label").eq(l.indexOf(parseInt(t.tradition.link.type))).trigger("click"),7==t.tradition.link.type&&(a.find(".panel-1 .other-link-box input").val(t.tradition.link.src),a.find(".panel-1 .btn-oth-ok").trigger("click")))}else a.find(".label-radio").eq(1).trigger("click"),a.find(".stt-date input").val(t.wx.datetime).trigger("blur"),a.find(".stt-author input").val(t.wx.author).trigger("blur"),a.find(".stt-link-text input").val(t.wx.linkTitle).trigger("blur"),"other"==t.wx.linkType&&(a.find(".other-link-radio ").trigger("click"),7==t.wx.link.type&&(a.find(".panel-2 .other-link-box input").val(t.wx.link.src),a.find(".panel-2 .btn-oth-ok").trigger("click")),a.find(".panel-2 .link-address label").eq(l.indexOf(parseInt(t.wx.link.type))).trigger("click"))}}})}(jQuery),function(){$.extend(zhx,{init:function(i){zhx.createOp(),zhx.bindOpEvent(),i&&i.length?zhx.resetInit(i):zhx.plugins.pageTitle.create("",{title:"店铺主页"}),zhx.activeView(zhx.holdPluginList[0].view)},resetInit:function(i){$.each(i,function(i,e){var t=zhx.plugins[e.key].create("",e);t.edit&&t.edit(e)})}})}();